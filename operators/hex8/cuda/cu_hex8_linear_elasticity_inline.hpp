#ifndef CU_HEX8_LINEAR_ELASTICITY_INLINE_HPP
#define CU_HEX8_LINEAR_ELASTICITY_INLINE_HPP

#include "cu_hex8_inline.hpp"

template <typename scalar_t>
static inline __device__ __host__ void cu_hex8_ref_shape_grad_x(const scalar_t qx,
                                                                const scalar_t qy,
                                                                const scalar_t qz,
                                                                scalar_t *const out) {
    const scalar_t x0 = 1 - qy;
    const scalar_t x1 = 1 - qz;
    const scalar_t x2 = x0 * x1;
    const scalar_t x3 = qy * x1;
    const scalar_t x4 = qz * x0;
    const scalar_t x5 = qy * qz;
    out[0] = -x2;
    out[1] = x2;
    out[2] = x3;
    out[3] = -x3;
    out[4] = -x4;
    out[5] = x4;
    out[6] = x5;
    out[7] = -x5;
}

template <typename scalar_t>
static inline __device__ __host__ void cu_hex8_ref_shape_grad_y(const scalar_t qx,
                                                                const scalar_t qy,
                                                                const scalar_t qz,
                                                                scalar_t *const out) {
    const scalar_t x0 = 1 - qx;
    const scalar_t x1 = 1 - qz;
    const scalar_t x2 = x0 * x1;
    const scalar_t x3 = qx * x1;
    const scalar_t x4 = qz * x0;
    const scalar_t x5 = qx * qz;
    out[0] = -x2;
    out[1] = -x3;
    out[2] = x3;
    out[3] = x2;
    out[4] = -x4;
    out[5] = -x5;
    out[6] = x5;
    out[7] = x4;
}

template <typename scalar_t>
static inline __device__ __host__ void cu_hex8_ref_shape_grad_z(const scalar_t qx,
                                                                const scalar_t qy,
                                                                const scalar_t qz,
                                                                scalar_t *const out) {
    const scalar_t x0 = 1 - qx;
    const scalar_t x1 = 1 - qy;
    const scalar_t x2 = x0 * x1;
    const scalar_t x3 = qx * x1;
    const scalar_t x4 = qx * qy;
    const scalar_t x5 = qy * x0;
    out[0] = -x2;
    out[1] = -x3;
    out[2] = -x4;
    out[3] = -x5;
    out[4] = x2;
    out[5] = x3;
    out[6] = x4;
    out[7] = x5;
}

template <typename scalar_t, typename accumulator_t>
static __host__ __device__ void cu_hex8_linear_elasticity_apply_adj(
        const scalar_t mu,
        const scalar_t lambda,
        const scalar_t *const SFEM_RESTRICT adjugate,
        const scalar_t jacobian_determinant,
        const scalar_t qx,
        const scalar_t qy,
        const scalar_t qz,
        const scalar_t qw,
        const scalar_t *const SFEM_RESTRICT ux,
        const scalar_t *const SFEM_RESTRICT uy,
        const scalar_t *const SFEM_RESTRICT uz,
        accumulator_t *const SFEM_RESTRICT outx,
        accumulator_t *const SFEM_RESTRICT outy,
        accumulator_t *const SFEM_RESTRICT outz) {
    const scalar_t denom = jacobian_determinant;
    scalar_t disp_grad[9] = {0, 0, 0, 0, 0, 0, 0, 0, 0};
    assert(denom > 0);
    {
        scalar_t temp[9] = {0, 0, 0, 0, 0, 0, 0, 0, 0};
        scalar_t grad[8];

        cu_hex8_ref_shape_grad_x(qx, qy, qz, grad);
#pragma unroll
        for (int i = 0; i < 8; i++) {
            const scalar_t g = grad[i];
            temp[0] += ux[i] * g;
            temp[3] += uy[i] * g;
            temp[6] += uz[i] * g;
        }

        cu_hex8_ref_shape_grad_y(qx, qy, qz, grad);
#pragma unroll
        for (int i = 0; i < 8; i++) {
            const scalar_t g = grad[i];
            temp[1] += ux[i] * g;
            temp[4] += uy[i] * g;
            temp[7] += uz[i] * g;
        }

        cu_hex8_ref_shape_grad_z(qx, qy, qz, grad);
#pragma unroll
        for (int i = 0; i < 8; i++) {
            const scalar_t g = grad[i];
            temp[2] += ux[i] * g;
            temp[5] += uy[i] * g;
            temp[8] += uz[i] * g;
        }

        for (int i = 0; i < 3; i++) {
#pragma unroll
            for (int j = 0; j < 3; j++) {
#pragma unroll
                for (int k = 0; k < 3; k++) {
                    disp_grad[i * 3 + j] += temp[i * 3 + k] * adjugate[k * 3 + j];
                    assert(disp_grad[i * 3 + j] == disp_grad[i * 3 + j]);
                }
            }
        }
    }

    scalar_t *P_tXJinv_t = disp_grad;
    {
        const scalar_t x0 = mu * (disp_grad[1] + disp_grad[3]);
        const scalar_t x1 = mu * (disp_grad[2] + disp_grad[6]);
        const scalar_t x2 = 2 * mu;
        const scalar_t x3 = lambda * (disp_grad[0] + disp_grad[4] + disp_grad[8]);
        const scalar_t x4 = disp_grad[0] * x2 + x3;
        const scalar_t x5 = mu * (disp_grad[5] + disp_grad[7]);
        const scalar_t x6 = disp_grad[4] * x2 + x3;
        const scalar_t x7 = disp_grad[8] * x2 + x3;
        P_tXJinv_t[0] = adjugate[0] * x4 + adjugate[1] * x0 + adjugate[2] * x1;
        P_tXJinv_t[1] = adjugate[3] * x4 + adjugate[4] * x0 + adjugate[5] * x1;
        P_tXJinv_t[2] = adjugate[6] * x4 + adjugate[7] * x0 + adjugate[8] * x1;
        P_tXJinv_t[3] = adjugate[0] * x0 + adjugate[1] * x6 + adjugate[2] * x5;
        P_tXJinv_t[4] = adjugate[3] * x0 + adjugate[4] * x6 + adjugate[5] * x5;
        P_tXJinv_t[5] = adjugate[6] * x0 + adjugate[7] * x6 + adjugate[8] * x5;
        P_tXJinv_t[6] = adjugate[0] * x1 + adjugate[1] * x5 + adjugate[2] * x7;
        P_tXJinv_t[7] = adjugate[3] * x1 + adjugate[4] * x5 + adjugate[5] * x7;
        P_tXJinv_t[8] = adjugate[6] * x1 + adjugate[7] * x5 + adjugate[8] * x7;
    }

    // Scale by quadrature weight
    for (int i = 0; i < 9; i++) {
        P_tXJinv_t[i] *= qw / denom;
        assert(P_tXJinv_t[i] == P_tXJinv_t[i]);
    }

    {
        scalar_t grad[8];
        cu_hex8_ref_shape_grad_x(qx, qy, qz, grad);

#pragma unroll
        for (int i = 0; i < 8; i++) {
            scalar_t g = grad[i];
            outx[i] += P_tXJinv_t[0] * g;
            outy[i] += P_tXJinv_t[3] * g;
            outz[i] += P_tXJinv_t[6] * g;
        }

        cu_hex8_ref_shape_grad_y(qx, qy, qz, grad);

#pragma unroll
        for (int i = 0; i < 8; i++) {
            scalar_t g = grad[i];
            outx[i] += P_tXJinv_t[1] * g;
            outy[i] += P_tXJinv_t[4] * g;
            outz[i] += P_tXJinv_t[7] * g;
        }

        cu_hex8_ref_shape_grad_z(qx, qy, qz, grad);

#pragma unroll
        for (int i = 0; i < 8; i++) {
            scalar_t g = grad[i];
            outx[i] += P_tXJinv_t[2] * g;
            outy[i] += P_tXJinv_t[5] * g;
            outz[i] += P_tXJinv_t[8] * g;
        }
    }

#ifndef NDEBUG
    for (int i = 0; i < 8; i++) {
        assert(outx[i] == outx[i]);
        assert(outy[i] == outy[i]);
        assert(outz[i] == outz[i]);
    }
#endif
}

//--------------------------
// hessian block_0_0
//--------------------------

template <typename scalar_t, typename accumulator_t>
static inline __host__ __device__ void cu_hex8_linear_elasticity_matrix_block_0_0(
        const scalar_t mu,
        const scalar_t lambda,
        const scalar_t *const SFEM_RESTRICT adjugate,
        const scalar_t jacobian_determinant,
        const scalar_t qx,
        const scalar_t qy,
        const scalar_t qz,
        const scalar_t qw,
        accumulator_t *const SFEM_RESTRICT element_matrix) {
    const scalar_t x0 = 1.0 / jacobian_determinant;
    const scalar_t x1 = 1 - qy;
    const scalar_t x2 = 1 - qz;
    const scalar_t x3 = x1 * x2;
    const scalar_t x4 = mu * qw;
    const scalar_t x5 = x3 * x4;
    const scalar_t x6 = adjugate[1] * x5;
    const scalar_t x7 = 1 - qx;
    const scalar_t x8 = x2 * x7;
    const scalar_t x9 = x4 * x8;
    const scalar_t x10 = adjugate[4] * x9;
    const scalar_t x11 = x1 * x7;
    const scalar_t x12 = x11 * x4;
    const scalar_t x13 = adjugate[7] * x12;
    const scalar_t x14 = x0 * (-x10 - x13 - x6);
    const scalar_t x15 = adjugate[2] * x5;
    const scalar_t x16 = adjugate[5] * x9;
    const scalar_t x17 = adjugate[8] * x12;
    const scalar_t x18 = x0 * (-x15 - x16 - x17);
    const scalar_t x19 = qw * (lambda + 2 * mu);
    const scalar_t x20 = adjugate[0] * x19;
    const scalar_t x21 = x20 * x3;
    const scalar_t x22 = adjugate[3] * x19;
    const scalar_t x23 = x22 * x8;
    const scalar_t x24 = adjugate[6] * x19;
    const scalar_t x25 = x11 * x24;
    const scalar_t x26 = x0 * (-x21 - x23 - x25);
    const scalar_t x27 = adjugate[6] * x26 + adjugate[7] * x14 + adjugate[8] * x18;
    const scalar_t x28 = x11 * x27;
    const scalar_t x29 = adjugate[3] * x26 + adjugate[4] * x14 + adjugate[5] * x18;
    const scalar_t x30 = x29 * x8;
    const scalar_t x31 = adjugate[0] * x26 + adjugate[1] * x14 + adjugate[2] * x18;
    const scalar_t x32 = x3 * x31;
    const scalar_t x33 = qx * x2;
    const scalar_t x34 = x33 * x4;
    const scalar_t x35 = adjugate[4] * x34;
    const scalar_t x36 = qx * x1;
    const scalar_t x37 = x36 * x4;
    const scalar_t x38 = adjugate[7] * x37;
    const scalar_t x39 = x0 * (-x35 - x38 + x6);
    const scalar_t x40 = adjugate[5] * x34;
    const scalar_t x41 = adjugate[8] * x37;
    const scalar_t x42 = x0 * (x15 - x40 - x41);
    const scalar_t x43 = x22 * x33;
    const scalar_t x44 = x24 * x36;
    const scalar_t x45 = x0 * (x21 - x43 - x44);
    const scalar_t x46 = adjugate[6] * x45 + adjugate[7] * x39 + adjugate[8] * x42;
    const scalar_t x47 = x11 * x46;
    const scalar_t x48 = adjugate[3] * x45 + adjugate[4] * x39 + adjugate[5] * x42;
    const scalar_t x49 = x48 * x8;
    const scalar_t x50 = adjugate[0] * x45 + adjugate[1] * x39 + adjugate[2] * x42;
    const scalar_t x51 = x3 * x50;
    const scalar_t x52 = qx * qy;
    const scalar_t x53 = x4 * x52;
    const scalar_t x54 = adjugate[7] * x53;
    const scalar_t x55 = qy * x2;
    const scalar_t x56 = x4 * x55;
    const scalar_t x57 = adjugate[1] * x56;
    const scalar_t x58 = x0 * (x35 - x54 + x57);
    const scalar_t x59 = adjugate[8] * x53;
    const scalar_t x60 = adjugate[2] * x56;
    const scalar_t x61 = x0 * (x40 - x59 + x60);
    const scalar_t x62 = x24 * x52;
    const scalar_t x63 = x20 * x55;
    const scalar_t x64 = x0 * (x43 - x62 + x63);
    const scalar_t x65 = adjugate[6] * x64 + adjugate[7] * x58 + adjugate[8] * x61;
    const scalar_t x66 = x11 * x65;
    const scalar_t x67 = adjugate[3] * x64 + adjugate[4] * x58 + adjugate[5] * x61;
    const scalar_t x68 = x67 * x8;
    const scalar_t x69 = adjugate[0] * x64 + adjugate[1] * x58 + adjugate[2] * x61;
    const scalar_t x70 = x3 * x69;
    const scalar_t x71 = qy * x7;
    const scalar_t x72 = x4 * x71;
    const scalar_t x73 = adjugate[7] * x72;
    const scalar_t x74 = x0 * (x10 - x57 - x73);
    const scalar_t x75 = adjugate[8] * x72;
    const scalar_t x76 = x0 * (x16 - x60 - x75);
    const scalar_t x77 = x24 * x71;
    const scalar_t x78 = x0 * (x23 - x63 - x77);
    const scalar_t x79 = adjugate[6] * x78 + adjugate[7] * x74 + adjugate[8] * x76;
    const scalar_t x80 = x11 * x79;
    const scalar_t x81 = adjugate[3] * x78 + adjugate[4] * x74 + adjugate[5] * x76;
    const scalar_t x82 = x8 * x81;
    const scalar_t x83 = adjugate[0] * x78 + adjugate[1] * x74 + adjugate[2] * x76;
    const scalar_t x84 = x3 * x83;
    const scalar_t x85 = qz * x1;
    const scalar_t x86 = x4 * x85;
    const scalar_t x87 = adjugate[1] * x86;
    const scalar_t x88 = qz * x7;
    const scalar_t x89 = x4 * x88;
    const scalar_t x90 = adjugate[4] * x89;
    const scalar_t x91 = x0 * (x13 - x87 - x90);
    const scalar_t x92 = adjugate[2] * x86;
    const scalar_t x93 = adjugate[5] * x89;
    const scalar_t x94 = x0 * (x17 - x92 - x93);
    const scalar_t x95 = x20 * x85;
    const scalar_t x96 = x22 * x88;
    const scalar_t x97 = x0 * (x25 - x95 - x96);
    const scalar_t x98 = adjugate[6] * x97 + adjugate[7] * x91 + adjugate[8] * x94;
    const scalar_t x99 = x11 * x98;
    const scalar_t x100 = adjugate[3] * x97 + adjugate[4] * x91 + adjugate[5] * x94;
    const scalar_t x101 = x100 * x8;
    const scalar_t x102 = adjugate[0] * x97 + adjugate[1] * x91 + adjugate[2] * x94;
    const scalar_t x103 = x102 * x3;
    const scalar_t x104 = qx * qz;
    const scalar_t x105 = x104 * x4;
    const scalar_t x106 = adjugate[4] * x105;
    const scalar_t x107 = x0 * (-x106 + x38 + x87);
    const scalar_t x108 = adjugate[5] * x105;
    const scalar_t x109 = x0 * (-x108 + x41 + x92);
    const scalar_t x110 = x104 * x22;
    const scalar_t x111 = x0 * (-x110 + x44 + x95);
    const scalar_t x112 = adjugate[6] * x111 + adjugate[7] * x107 + adjugate[8] * x109;
    const scalar_t x113 = x11 * x112;
    const scalar_t x114 = adjugate[3] * x111 + adjugate[4] * x107 + adjugate[5] * x109;
    const scalar_t x115 = x114 * x8;
    const scalar_t x116 = adjugate[0] * x111 + adjugate[1] * x107 + adjugate[2] * x109;
    const scalar_t x117 = x116 * x3;
    const scalar_t x118 = qy * qz;
    const scalar_t x119 = x118 * x4;
    const scalar_t x120 = adjugate[1] * x119;
    const scalar_t x121 = x0 * (x106 + x120 + x54);
    const scalar_t x122 = adjugate[2] * x119;
    const scalar_t x123 = x0 * (x108 + x122 + x59);
    const scalar_t x124 = x118 * x20;
    const scalar_t x125 = x0 * (x110 + x124 + x62);
    const scalar_t x126 = adjugate[6] * x125 + adjugate[7] * x121 + adjugate[8] * x123;
    const scalar_t x127 = x11 * x126;
    const scalar_t x128 = adjugate[3] * x125 + adjugate[4] * x121 + adjugate[5] * x123;
    const scalar_t x129 = x128 * x8;
    const scalar_t x130 = adjugate[0] * x125 + adjugate[1] * x121 + adjugate[2] * x123;
    const scalar_t x131 = x130 * x3;
    const scalar_t x132 = x0 * (-x120 + x73 + x90);
    const scalar_t x133 = x0 * (-x122 + x75 + x93);
    const scalar_t x134 = x0 * (-x124 + x77 + x96);
    const scalar_t x135 = adjugate[6] * x134 + adjugate[7] * x132 + adjugate[8] * x133;
    const scalar_t x136 = x11 * x135;
    const scalar_t x137 = adjugate[3] * x134 + adjugate[4] * x132 + adjugate[5] * x133;
    const scalar_t x138 = x137 * x8;
    const scalar_t x139 = adjugate[0] * x134 + adjugate[1] * x132 + adjugate[2] * x133;
    const scalar_t x140 = x139 * x3;
    const scalar_t x141 = x27 * x36;
    const scalar_t x142 = x29 * x33;
    const scalar_t x143 = x36 * x46;
    const scalar_t x144 = x33 * x48;
    const scalar_t x145 = x36 * x65;
    const scalar_t x146 = x33 * x67;
    const scalar_t x147 = x36 * x79;
    const scalar_t x148 = x33 * x81;
    const scalar_t x149 = x36 * x98;
    const scalar_t x150 = x100 * x33;
    const scalar_t x151 = x112 * x36;
    const scalar_t x152 = x114 * x33;
    const scalar_t x153 = x126 * x36;
    const scalar_t x154 = x128 * x33;
    const scalar_t x155 = x135 * x36;
    const scalar_t x156 = x137 * x33;
    const scalar_t x157 = x27 * x52;
    const scalar_t x158 = x31 * x55;
    const scalar_t x159 = x46 * x52;
    const scalar_t x160 = x50 * x55;
    const scalar_t x161 = x52 * x65;
    const scalar_t x162 = x55 * x69;
    const scalar_t x163 = x52 * x79;
    const scalar_t x164 = x55 * x83;
    const scalar_t x165 = x52 * x98;
    const scalar_t x166 = x102 * x55;
    const scalar_t x167 = x112 * x52;
    const scalar_t x168 = x116 * x55;
    const scalar_t x169 = x126 * x52;
    const scalar_t x170 = x130 * x55;
    const scalar_t x171 = x135 * x52;
    const scalar_t x172 = x139 * x55;
    const scalar_t x173 = x27 * x71;
    const scalar_t x174 = x46 * x71;
    const scalar_t x175 = x65 * x71;
    const scalar_t x176 = x71 * x79;
    const scalar_t x177 = x71 * x98;
    const scalar_t x178 = x112 * x71;
    const scalar_t x179 = x126 * x71;
    const scalar_t x180 = x135 * x71;
    const scalar_t x181 = x29 * x88;
    const scalar_t x182 = x31 * x85;
    const scalar_t x183 = x48 * x88;
    const scalar_t x184 = x50 * x85;
    const scalar_t x185 = x67 * x88;
    const scalar_t x186 = x69 * x85;
    const scalar_t x187 = x81 * x88;
    const scalar_t x188 = x83 * x85;
    const scalar_t x189 = x100 * x88;
    const scalar_t x190 = x102 * x85;
    const scalar_t x191 = x114 * x88;
    const scalar_t x192 = x116 * x85;
    const scalar_t x193 = x128 * x88;
    const scalar_t x194 = x130 * x85;
    const scalar_t x195 = x137 * x88;
    const scalar_t x196 = x139 * x85;
    const scalar_t x197 = x104 * x29;
    const scalar_t x198 = x104 * x48;
    const scalar_t x199 = x104 * x67;
    const scalar_t x200 = x104 * x81;
    const scalar_t x201 = x100 * x104;
    const scalar_t x202 = x104 * x114;
    const scalar_t x203 = x104 * x128;
    const scalar_t x204 = x104 * x137;
    const scalar_t x205 = x118 * x31;
    const scalar_t x206 = x118 * x50;
    const scalar_t x207 = x118 * x69;
    const scalar_t x208 = x118 * x83;
    const scalar_t x209 = x102 * x118;
    const scalar_t x210 = x116 * x118;
    const scalar_t x211 = x118 * x130;
    const scalar_t x212 = x118 * x139;
    element_matrix[0] += -x28 - x30 - x32;
    element_matrix[1] += -x47 - x49 - x51;
    element_matrix[2] += -x66 - x68 - x70;
    element_matrix[3] += -x80 - x82 - x84;
    element_matrix[4] += -x101 - x103 - x99;
    element_matrix[5] += -x113 - x115 - x117;
    element_matrix[6] += -x127 - x129 - x131;
    element_matrix[7] += -x136 - x138 - x140;
    element_matrix[8] += -x141 - x142 + x32;
    element_matrix[9] += -x143 - x144 + x51;
    element_matrix[10] += -x145 - x146 + x70;
    element_matrix[11] += -x147 - x148 + x84;
    element_matrix[12] += x103 - x149 - x150;
    element_matrix[13] += x117 - x151 - x152;
    element_matrix[14] += x131 - x153 - x154;
    element_matrix[15] += x140 - x155 - x156;
    element_matrix[16] += x142 - x157 + x158;
    element_matrix[17] += x144 - x159 + x160;
    element_matrix[18] += x146 - x161 + x162;
    element_matrix[19] += x148 - x163 + x164;
    element_matrix[20] += x150 - x165 + x166;
    element_matrix[21] += x152 - x167 + x168;
    element_matrix[22] += x154 - x169 + x170;
    element_matrix[23] += x156 - x171 + x172;
    element_matrix[24] += -x158 - x173 + x30;
    element_matrix[25] += -x160 - x174 + x49;
    element_matrix[26] += -x162 - x175 + x68;
    element_matrix[27] += -x164 - x176 + x82;
    element_matrix[28] += x101 - x166 - x177;
    element_matrix[29] += x115 - x168 - x178;
    element_matrix[30] += x129 - x170 - x179;
    element_matrix[31] += x138 - x172 - x180;
    element_matrix[32] += -x181 - x182 + x28;
    element_matrix[33] += -x183 - x184 + x47;
    element_matrix[34] += -x185 - x186 + x66;
    element_matrix[35] += -x187 - x188 + x80;
    element_matrix[36] += -x189 - x190 + x99;
    element_matrix[37] += x113 - x191 - x192;
    element_matrix[38] += x127 - x193 - x194;
    element_matrix[39] += x136 - x195 - x196;
    element_matrix[40] += x141 + x182 - x197;
    element_matrix[41] += x143 + x184 - x198;
    element_matrix[42] += x145 + x186 - x199;
    element_matrix[43] += x147 + x188 - x200;
    element_matrix[44] += x149 + x190 - x201;
    element_matrix[45] += x151 + x192 - x202;
    element_matrix[46] += x153 + x194 - x203;
    element_matrix[47] += x155 + x196 - x204;
    element_matrix[48] += x157 + x197 + x205;
    element_matrix[49] += x159 + x198 + x206;
    element_matrix[50] += x161 + x199 + x207;
    element_matrix[51] += x163 + x200 + x208;
    element_matrix[52] += x165 + x201 + x209;
    element_matrix[53] += x167 + x202 + x210;
    element_matrix[54] += x169 + x203 + x211;
    element_matrix[55] += x171 + x204 + x212;
    element_matrix[56] += x173 + x181 - x205;
    element_matrix[57] += x174 + x183 - x206;
    element_matrix[58] += x175 + x185 - x207;
    element_matrix[59] += x176 + x187 - x208;
    element_matrix[60] += x177 + x189 - x209;
    element_matrix[61] += x178 + x191 - x210;
    element_matrix[62] += x179 + x193 - x211;
    element_matrix[63] += x180 + x195 - x212;
}

//--------------------------
// hessian block_0_1
//--------------------------

template <typename scalar_t, typename accumulator_t>
static inline __host__ __device__ void cu_hex8_linear_elasticity_matrix_block_0_1(
        const scalar_t mu,
        const scalar_t lambda,
        const scalar_t *const SFEM_RESTRICT adjugate,
        const scalar_t jacobian_determinant,
        const scalar_t qx,
        const scalar_t qy,
        const scalar_t qz,
        const scalar_t qw,
        accumulator_t *const SFEM_RESTRICT element_matrix) {
    const scalar_t x0 = 1.0 / jacobian_determinant;
    const scalar_t x1 = 1 - qy;
    const scalar_t x2 = 1 - qz;
    const scalar_t x3 = x1 * x2;
    const scalar_t x4 = lambda * qw;
    const scalar_t x5 = adjugate[1] * x4;
    const scalar_t x6 = x3 * x5;
    const scalar_t x7 = 1 - qx;
    const scalar_t x8 = x2 * x7;
    const scalar_t x9 = adjugate[4] * x4;
    const scalar_t x10 = x8 * x9;
    const scalar_t x11 = x1 * x7;
    const scalar_t x12 = adjugate[7] * x4;
    const scalar_t x13 = x11 * x12;
    const scalar_t x14 = x0 * (-x10 - x13 - x6);
    const scalar_t x15 = mu * qw;
    const scalar_t x16 = adjugate[0] * x15;
    const scalar_t x17 = x16 * x3;
    const scalar_t x18 = adjugate[3] * x15;
    const scalar_t x19 = x18 * x8;
    const scalar_t x20 = adjugate[6] * x15;
    const scalar_t x21 = x11 * x20;
    const scalar_t x22 = x0 * (-x17 - x19 - x21);
    const scalar_t x23 = adjugate[6] * x14 + adjugate[7] * x22;
    const scalar_t x24 = x11 * x23;
    const scalar_t x25 = adjugate[3] * x14 + adjugate[4] * x22;
    const scalar_t x26 = x25 * x8;
    const scalar_t x27 = adjugate[0] * x14 + adjugate[1] * x22;
    const scalar_t x28 = x27 * x3;
    const scalar_t x29 = qx * x2;
    const scalar_t x30 = x29 * x9;
    const scalar_t x31 = qx * x1;
    const scalar_t x32 = x12 * x31;
    const scalar_t x33 = x0 * (-x30 - x32 + x6);
    const scalar_t x34 = x18 * x29;
    const scalar_t x35 = x20 * x31;
    const scalar_t x36 = x0 * (x17 - x34 - x35);
    const scalar_t x37 = adjugate[6] * x33 + adjugate[7] * x36;
    const scalar_t x38 = x11 * x37;
    const scalar_t x39 = adjugate[3] * x33 + adjugate[4] * x36;
    const scalar_t x40 = x39 * x8;
    const scalar_t x41 = adjugate[0] * x33 + adjugate[1] * x36;
    const scalar_t x42 = x3 * x41;
    const scalar_t x43 = qx * qy;
    const scalar_t x44 = x12 * x43;
    const scalar_t x45 = qy * x2;
    const scalar_t x46 = x45 * x5;
    const scalar_t x47 = x0 * (x30 - x44 + x46);
    const scalar_t x48 = x20 * x43;
    const scalar_t x49 = x16 * x45;
    const scalar_t x50 = x0 * (x34 - x48 + x49);
    const scalar_t x51 = adjugate[6] * x47 + adjugate[7] * x50;
    const scalar_t x52 = x11 * x51;
    const scalar_t x53 = adjugate[3] * x47 + adjugate[4] * x50;
    const scalar_t x54 = x53 * x8;
    const scalar_t x55 = adjugate[0] * x47 + adjugate[1] * x50;
    const scalar_t x56 = x3 * x55;
    const scalar_t x57 = qy * x7;
    const scalar_t x58 = x12 * x57;
    const scalar_t x59 = x0 * (x10 - x46 - x58);
    const scalar_t x60 = x20 * x57;
    const scalar_t x61 = x0 * (x19 - x49 - x60);
    const scalar_t x62 = adjugate[6] * x59 + adjugate[7] * x61;
    const scalar_t x63 = x11 * x62;
    const scalar_t x64 = adjugate[3] * x59 + adjugate[4] * x61;
    const scalar_t x65 = x64 * x8;
    const scalar_t x66 = adjugate[0] * x59 + adjugate[1] * x61;
    const scalar_t x67 = x3 * x66;
    const scalar_t x68 = qz * x1;
    const scalar_t x69 = x5 * x68;
    const scalar_t x70 = qz * x7;
    const scalar_t x71 = x70 * x9;
    const scalar_t x72 = x0 * (x13 - x69 - x71);
    const scalar_t x73 = x16 * x68;
    const scalar_t x74 = x18 * x70;
    const scalar_t x75 = x0 * (x21 - x73 - x74);
    const scalar_t x76 = adjugate[6] * x72 + adjugate[7] * x75;
    const scalar_t x77 = x11 * x76;
    const scalar_t x78 = adjugate[3] * x72 + adjugate[4] * x75;
    const scalar_t x79 = x78 * x8;
    const scalar_t x80 = adjugate[0] * x72 + adjugate[1] * x75;
    const scalar_t x81 = x3 * x80;
    const scalar_t x82 = qx * qz;
    const scalar_t x83 = x82 * x9;
    const scalar_t x84 = x0 * (x32 + x69 - x83);
    const scalar_t x85 = x18 * x82;
    const scalar_t x86 = x0 * (x35 + x73 - x85);
    const scalar_t x87 = adjugate[6] * x84 + adjugate[7] * x86;
    const scalar_t x88 = x11 * x87;
    const scalar_t x89 = adjugate[3] * x84 + adjugate[4] * x86;
    const scalar_t x90 = x8 * x89;
    const scalar_t x91 = adjugate[0] * x84 + adjugate[1] * x86;
    const scalar_t x92 = x3 * x91;
    const scalar_t x93 = qy * qz;
    const scalar_t x94 = x5 * x93;
    const scalar_t x95 = x0 * (x44 + x83 + x94);
    const scalar_t x96 = x16 * x93;
    const scalar_t x97 = x0 * (x48 + x85 + x96);
    const scalar_t x98 = adjugate[6] * x95 + adjugate[7] * x97;
    const scalar_t x99 = x11 * x98;
    const scalar_t x100 = adjugate[3] * x95 + adjugate[4] * x97;
    const scalar_t x101 = x100 * x8;
    const scalar_t x102 = adjugate[0] * x95 + adjugate[1] * x97;
    const scalar_t x103 = x102 * x3;
    const scalar_t x104 = x0 * (x58 + x71 - x94);
    const scalar_t x105 = x0 * (x60 + x74 - x96);
    const scalar_t x106 = adjugate[6] * x104 + adjugate[7] * x105;
    const scalar_t x107 = x106 * x11;
    const scalar_t x108 = adjugate[3] * x104 + adjugate[4] * x105;
    const scalar_t x109 = x108 * x8;
    const scalar_t x110 = adjugate[0] * x104 + adjugate[1] * x105;
    const scalar_t x111 = x110 * x3;
    const scalar_t x112 = x23 * x31;
    const scalar_t x113 = x25 * x29;
    const scalar_t x114 = x31 * x37;
    const scalar_t x115 = x29 * x39;
    const scalar_t x116 = x31 * x51;
    const scalar_t x117 = x29 * x53;
    const scalar_t x118 = x31 * x62;
    const scalar_t x119 = x29 * x64;
    const scalar_t x120 = x31 * x76;
    const scalar_t x121 = x29 * x78;
    const scalar_t x122 = x31 * x87;
    const scalar_t x123 = x29 * x89;
    const scalar_t x124 = x31 * x98;
    const scalar_t x125 = x100 * x29;
    const scalar_t x126 = x106 * x31;
    const scalar_t x127 = x108 * x29;
    const scalar_t x128 = x23 * x43;
    const scalar_t x129 = x27 * x45;
    const scalar_t x130 = x37 * x43;
    const scalar_t x131 = x41 * x45;
    const scalar_t x132 = x43 * x51;
    const scalar_t x133 = x45 * x55;
    const scalar_t x134 = x43 * x62;
    const scalar_t x135 = x45 * x66;
    const scalar_t x136 = x43 * x76;
    const scalar_t x137 = x45 * x80;
    const scalar_t x138 = x43 * x87;
    const scalar_t x139 = x45 * x91;
    const scalar_t x140 = x43 * x98;
    const scalar_t x141 = x102 * x45;
    const scalar_t x142 = x106 * x43;
    const scalar_t x143 = x110 * x45;
    const scalar_t x144 = x23 * x57;
    const scalar_t x145 = x37 * x57;
    const scalar_t x146 = x51 * x57;
    const scalar_t x147 = x57 * x62;
    const scalar_t x148 = x57 * x76;
    const scalar_t x149 = x57 * x87;
    const scalar_t x150 = x57 * x98;
    const scalar_t x151 = x106 * x57;
    const scalar_t x152 = x25 * x70;
    const scalar_t x153 = x27 * x68;
    const scalar_t x154 = x39 * x70;
    const scalar_t x155 = x41 * x68;
    const scalar_t x156 = x53 * x70;
    const scalar_t x157 = x55 * x68;
    const scalar_t x158 = x64 * x70;
    const scalar_t x159 = x66 * x68;
    const scalar_t x160 = x70 * x78;
    const scalar_t x161 = x68 * x80;
    const scalar_t x162 = x70 * x89;
    const scalar_t x163 = x68 * x91;
    const scalar_t x164 = x100 * x70;
    const scalar_t x165 = x102 * x68;
    const scalar_t x166 = x108 * x70;
    const scalar_t x167 = x110 * x68;
    const scalar_t x168 = x25 * x82;
    const scalar_t x169 = x39 * x82;
    const scalar_t x170 = x53 * x82;
    const scalar_t x171 = x64 * x82;
    const scalar_t x172 = x78 * x82;
    const scalar_t x173 = x82 * x89;
    const scalar_t x174 = x100 * x82;
    const scalar_t x175 = x108 * x82;
    const scalar_t x176 = x27 * x93;
    const scalar_t x177 = x41 * x93;
    const scalar_t x178 = x55 * x93;
    const scalar_t x179 = x66 * x93;
    const scalar_t x180 = x80 * x93;
    const scalar_t x181 = x91 * x93;
    const scalar_t x182 = x102 * x93;
    const scalar_t x183 = x110 * x93;
    element_matrix[0] += -x24 - x26 - x28;
    element_matrix[1] += -x38 - x40 - x42;
    element_matrix[2] += -x52 - x54 - x56;
    element_matrix[3] += -x63 - x65 - x67;
    element_matrix[4] += -x77 - x79 - x81;
    element_matrix[5] += -x88 - x90 - x92;
    element_matrix[6] += -x101 - x103 - x99;
    element_matrix[7] += -x107 - x109 - x111;
    element_matrix[8] += -x112 - x113 + x28;
    element_matrix[9] += -x114 - x115 + x42;
    element_matrix[10] += -x116 - x117 + x56;
    element_matrix[11] += -x118 - x119 + x67;
    element_matrix[12] += -x120 - x121 + x81;
    element_matrix[13] += -x122 - x123 + x92;
    element_matrix[14] += x103 - x124 - x125;
    element_matrix[15] += x111 - x126 - x127;
    element_matrix[16] += x113 - x128 + x129;
    element_matrix[17] += x115 - x130 + x131;
    element_matrix[18] += x117 - x132 + x133;
    element_matrix[19] += x119 - x134 + x135;
    element_matrix[20] += x121 - x136 + x137;
    element_matrix[21] += x123 - x138 + x139;
    element_matrix[22] += x125 - x140 + x141;
    element_matrix[23] += x127 - x142 + x143;
    element_matrix[24] += -x129 - x144 + x26;
    element_matrix[25] += -x131 - x145 + x40;
    element_matrix[26] += -x133 - x146 + x54;
    element_matrix[27] += -x135 - x147 + x65;
    element_matrix[28] += -x137 - x148 + x79;
    element_matrix[29] += -x139 - x149 + x90;
    element_matrix[30] += x101 - x141 - x150;
    element_matrix[31] += x109 - x143 - x151;
    element_matrix[32] += -x152 - x153 + x24;
    element_matrix[33] += -x154 - x155 + x38;
    element_matrix[34] += -x156 - x157 + x52;
    element_matrix[35] += -x158 - x159 + x63;
    element_matrix[36] += -x160 - x161 + x77;
    element_matrix[37] += -x162 - x163 + x88;
    element_matrix[38] += -x164 - x165 + x99;
    element_matrix[39] += x107 - x166 - x167;
    element_matrix[40] += x112 + x153 - x168;
    element_matrix[41] += x114 + x155 - x169;
    element_matrix[42] += x116 + x157 - x170;
    element_matrix[43] += x118 + x159 - x171;
    element_matrix[44] += x120 + x161 - x172;
    element_matrix[45] += x122 + x163 - x173;
    element_matrix[46] += x124 + x165 - x174;
    element_matrix[47] += x126 + x167 - x175;
    element_matrix[48] += x128 + x168 + x176;
    element_matrix[49] += x130 + x169 + x177;
    element_matrix[50] += x132 + x170 + x178;
    element_matrix[51] += x134 + x171 + x179;
    element_matrix[52] += x136 + x172 + x180;
    element_matrix[53] += x138 + x173 + x181;
    element_matrix[54] += x140 + x174 + x182;
    element_matrix[55] += x142 + x175 + x183;
    element_matrix[56] += x144 + x152 - x176;
    element_matrix[57] += x145 + x154 - x177;
    element_matrix[58] += x146 + x156 - x178;
    element_matrix[59] += x147 + x158 - x179;
    element_matrix[60] += x148 + x160 - x180;
    element_matrix[61] += x149 + x162 - x181;
    element_matrix[62] += x150 + x164 - x182;
    element_matrix[63] += x151 + x166 - x183;
}

//--------------------------
// hessian block_0_2
//--------------------------

template <typename scalar_t, typename accumulator_t>
static inline __host__ __device__ void cu_hex8_linear_elasticity_matrix_block_0_2(
        const scalar_t mu,
        const scalar_t lambda,
        const scalar_t *const SFEM_RESTRICT adjugate,
        const scalar_t jacobian_determinant,
        const scalar_t qx,
        const scalar_t qy,
        const scalar_t qz,
        const scalar_t qw,
        accumulator_t *const SFEM_RESTRICT element_matrix) {
    const scalar_t x0 = 1.0 / jacobian_determinant;
    const scalar_t x1 = 1 - qy;
    const scalar_t x2 = 1 - qz;
    const scalar_t x3 = x1 * x2;
    const scalar_t x4 = lambda * qw;
    const scalar_t x5 = adjugate[2] * x4;
    const scalar_t x6 = x3 * x5;
    const scalar_t x7 = 1 - qx;
    const scalar_t x8 = x2 * x7;
    const scalar_t x9 = adjugate[5] * x4;
    const scalar_t x10 = x8 * x9;
    const scalar_t x11 = x1 * x7;
    const scalar_t x12 = adjugate[8] * x4;
    const scalar_t x13 = x11 * x12;
    const scalar_t x14 = x0 * (-x10 - x13 - x6);
    const scalar_t x15 = mu * qw;
    const scalar_t x16 = adjugate[0] * x15;
    const scalar_t x17 = x16 * x3;
    const scalar_t x18 = adjugate[3] * x15;
    const scalar_t x19 = x18 * x8;
    const scalar_t x20 = adjugate[6] * x15;
    const scalar_t x21 = x11 * x20;
    const scalar_t x22 = x0 * (-x17 - x19 - x21);
    const scalar_t x23 = adjugate[6] * x14 + adjugate[8] * x22;
    const scalar_t x24 = x11 * x23;
    const scalar_t x25 = adjugate[3] * x14 + adjugate[5] * x22;
    const scalar_t x26 = x25 * x8;
    const scalar_t x27 = adjugate[0] * x14 + adjugate[2] * x22;
    const scalar_t x28 = x27 * x3;
    const scalar_t x29 = qx * x2;
    const scalar_t x30 = x29 * x9;
    const scalar_t x31 = qx * x1;
    const scalar_t x32 = x12 * x31;
    const scalar_t x33 = x0 * (-x30 - x32 + x6);
    const scalar_t x34 = x18 * x29;
    const scalar_t x35 = x20 * x31;
    const scalar_t x36 = x0 * (x17 - x34 - x35);
    const scalar_t x37 = adjugate[6] * x33 + adjugate[8] * x36;
    const scalar_t x38 = x11 * x37;
    const scalar_t x39 = adjugate[3] * x33 + adjugate[5] * x36;
    const scalar_t x40 = x39 * x8;
    const scalar_t x41 = adjugate[0] * x33 + adjugate[2] * x36;
    const scalar_t x42 = x3 * x41;
    const scalar_t x43 = qx * qy;
    const scalar_t x44 = x12 * x43;
    const scalar_t x45 = qy * x2;
    const scalar_t x46 = x45 * x5;
    const scalar_t x47 = x0 * (x30 - x44 + x46);
    const scalar_t x48 = x20 * x43;
    const scalar_t x49 = x16 * x45;
    const scalar_t x50 = x0 * (x34 - x48 + x49);
    const scalar_t x51 = adjugate[6] * x47 + adjugate[8] * x50;
    const scalar_t x52 = x11 * x51;
    const scalar_t x53 = adjugate[3] * x47 + adjugate[5] * x50;
    const scalar_t x54 = x53 * x8;
    const scalar_t x55 = adjugate[0] * x47 + adjugate[2] * x50;
    const scalar_t x56 = x3 * x55;
    const scalar_t x57 = qy * x7;
    const scalar_t x58 = x12 * x57;
    const scalar_t x59 = x0 * (x10 - x46 - x58);
    const scalar_t x60 = x20 * x57;
    const scalar_t x61 = x0 * (x19 - x49 - x60);
    const scalar_t x62 = adjugate[6] * x59 + adjugate[8] * x61;
    const scalar_t x63 = x11 * x62;
    const scalar_t x64 = adjugate[3] * x59 + adjugate[5] * x61;
    const scalar_t x65 = x64 * x8;
    const scalar_t x66 = adjugate[0] * x59 + adjugate[2] * x61;
    const scalar_t x67 = x3 * x66;
    const scalar_t x68 = qz * x1;
    const scalar_t x69 = x5 * x68;
    const scalar_t x70 = qz * x7;
    const scalar_t x71 = x70 * x9;
    const scalar_t x72 = x0 * (x13 - x69 - x71);
    const scalar_t x73 = x16 * x68;
    const scalar_t x74 = x18 * x70;
    const scalar_t x75 = x0 * (x21 - x73 - x74);
    const scalar_t x76 = adjugate[6] * x72 + adjugate[8] * x75;
    const scalar_t x77 = x11 * x76;
    const scalar_t x78 = adjugate[3] * x72 + adjugate[5] * x75;
    const scalar_t x79 = x78 * x8;
    const scalar_t x80 = adjugate[0] * x72 + adjugate[2] * x75;
    const scalar_t x81 = x3 * x80;
    const scalar_t x82 = qx * qz;
    const scalar_t x83 = x82 * x9;
    const scalar_t x84 = x0 * (x32 + x69 - x83);
    const scalar_t x85 = x18 * x82;
    const scalar_t x86 = x0 * (x35 + x73 - x85);
    const scalar_t x87 = adjugate[6] * x84 + adjugate[8] * x86;
    const scalar_t x88 = x11 * x87;
    const scalar_t x89 = adjugate[3] * x84 + adjugate[5] * x86;
    const scalar_t x90 = x8 * x89;
    const scalar_t x91 = adjugate[0] * x84 + adjugate[2] * x86;
    const scalar_t x92 = x3 * x91;
    const scalar_t x93 = qy * qz;
    const scalar_t x94 = x5 * x93;
    const scalar_t x95 = x0 * (x44 + x83 + x94);
    const scalar_t x96 = x16 * x93;
    const scalar_t x97 = x0 * (x48 + x85 + x96);
    const scalar_t x98 = adjugate[6] * x95 + adjugate[8] * x97;
    const scalar_t x99 = x11 * x98;
    const scalar_t x100 = adjugate[3] * x95 + adjugate[5] * x97;
    const scalar_t x101 = x100 * x8;
    const scalar_t x102 = adjugate[0] * x95 + adjugate[2] * x97;
    const scalar_t x103 = x102 * x3;
    const scalar_t x104 = x0 * (x58 + x71 - x94);
    const scalar_t x105 = x0 * (x60 + x74 - x96);
    const scalar_t x106 = adjugate[6] * x104 + adjugate[8] * x105;
    const scalar_t x107 = x106 * x11;
    const scalar_t x108 = adjugate[3] * x104 + adjugate[5] * x105;
    const scalar_t x109 = x108 * x8;
    const scalar_t x110 = adjugate[0] * x104 + adjugate[2] * x105;
    const scalar_t x111 = x110 * x3;
    const scalar_t x112 = x23 * x31;
    const scalar_t x113 = x25 * x29;
    const scalar_t x114 = x31 * x37;
    const scalar_t x115 = x29 * x39;
    const scalar_t x116 = x31 * x51;
    const scalar_t x117 = x29 * x53;
    const scalar_t x118 = x31 * x62;
    const scalar_t x119 = x29 * x64;
    const scalar_t x120 = x31 * x76;
    const scalar_t x121 = x29 * x78;
    const scalar_t x122 = x31 * x87;
    const scalar_t x123 = x29 * x89;
    const scalar_t x124 = x31 * x98;
    const scalar_t x125 = x100 * x29;
    const scalar_t x126 = x106 * x31;
    const scalar_t x127 = x108 * x29;
    const scalar_t x128 = x23 * x43;
    const scalar_t x129 = x27 * x45;
    const scalar_t x130 = x37 * x43;
    const scalar_t x131 = x41 * x45;
    const scalar_t x132 = x43 * x51;
    const scalar_t x133 = x45 * x55;
    const scalar_t x134 = x43 * x62;
    const scalar_t x135 = x45 * x66;
    const scalar_t x136 = x43 * x76;
    const scalar_t x137 = x45 * x80;
    const scalar_t x138 = x43 * x87;
    const scalar_t x139 = x45 * x91;
    const scalar_t x140 = x43 * x98;
    const scalar_t x141 = x102 * x45;
    const scalar_t x142 = x106 * x43;
    const scalar_t x143 = x110 * x45;
    const scalar_t x144 = x23 * x57;
    const scalar_t x145 = x37 * x57;
    const scalar_t x146 = x51 * x57;
    const scalar_t x147 = x57 * x62;
    const scalar_t x148 = x57 * x76;
    const scalar_t x149 = x57 * x87;
    const scalar_t x150 = x57 * x98;
    const scalar_t x151 = x106 * x57;
    const scalar_t x152 = x25 * x70;
    const scalar_t x153 = x27 * x68;
    const scalar_t x154 = x39 * x70;
    const scalar_t x155 = x41 * x68;
    const scalar_t x156 = x53 * x70;
    const scalar_t x157 = x55 * x68;
    const scalar_t x158 = x64 * x70;
    const scalar_t x159 = x66 * x68;
    const scalar_t x160 = x70 * x78;
    const scalar_t x161 = x68 * x80;
    const scalar_t x162 = x70 * x89;
    const scalar_t x163 = x68 * x91;
    const scalar_t x164 = x100 * x70;
    const scalar_t x165 = x102 * x68;
    const scalar_t x166 = x108 * x70;
    const scalar_t x167 = x110 * x68;
    const scalar_t x168 = x25 * x82;
    const scalar_t x169 = x39 * x82;
    const scalar_t x170 = x53 * x82;
    const scalar_t x171 = x64 * x82;
    const scalar_t x172 = x78 * x82;
    const scalar_t x173 = x82 * x89;
    const scalar_t x174 = x100 * x82;
    const scalar_t x175 = x108 * x82;
    const scalar_t x176 = x27 * x93;
    const scalar_t x177 = x41 * x93;
    const scalar_t x178 = x55 * x93;
    const scalar_t x179 = x66 * x93;
    const scalar_t x180 = x80 * x93;
    const scalar_t x181 = x91 * x93;
    const scalar_t x182 = x102 * x93;
    const scalar_t x183 = x110 * x93;
    element_matrix[0] += -x24 - x26 - x28;
    element_matrix[1] += -x38 - x40 - x42;
    element_matrix[2] += -x52 - x54 - x56;
    element_matrix[3] += -x63 - x65 - x67;
    element_matrix[4] += -x77 - x79 - x81;
    element_matrix[5] += -x88 - x90 - x92;
    element_matrix[6] += -x101 - x103 - x99;
    element_matrix[7] += -x107 - x109 - x111;
    element_matrix[8] += -x112 - x113 + x28;
    element_matrix[9] += -x114 - x115 + x42;
    element_matrix[10] += -x116 - x117 + x56;
    element_matrix[11] += -x118 - x119 + x67;
    element_matrix[12] += -x120 - x121 + x81;
    element_matrix[13] += -x122 - x123 + x92;
    element_matrix[14] += x103 - x124 - x125;
    element_matrix[15] += x111 - x126 - x127;
    element_matrix[16] += x113 - x128 + x129;
    element_matrix[17] += x115 - x130 + x131;
    element_matrix[18] += x117 - x132 + x133;
    element_matrix[19] += x119 - x134 + x135;
    element_matrix[20] += x121 - x136 + x137;
    element_matrix[21] += x123 - x138 + x139;
    element_matrix[22] += x125 - x140 + x141;
    element_matrix[23] += x127 - x142 + x143;
    element_matrix[24] += -x129 - x144 + x26;
    element_matrix[25] += -x131 - x145 + x40;
    element_matrix[26] += -x133 - x146 + x54;
    element_matrix[27] += -x135 - x147 + x65;
    element_matrix[28] += -x137 - x148 + x79;
    element_matrix[29] += -x139 - x149 + x90;
    element_matrix[30] += x101 - x141 - x150;
    element_matrix[31] += x109 - x143 - x151;
    element_matrix[32] += -x152 - x153 + x24;
    element_matrix[33] += -x154 - x155 + x38;
    element_matrix[34] += -x156 - x157 + x52;
    element_matrix[35] += -x158 - x159 + x63;
    element_matrix[36] += -x160 - x161 + x77;
    element_matrix[37] += -x162 - x163 + x88;
    element_matrix[38] += -x164 - x165 + x99;
    element_matrix[39] += x107 - x166 - x167;
    element_matrix[40] += x112 + x153 - x168;
    element_matrix[41] += x114 + x155 - x169;
    element_matrix[42] += x116 + x157 - x170;
    element_matrix[43] += x118 + x159 - x171;
    element_matrix[44] += x120 + x161 - x172;
    element_matrix[45] += x122 + x163 - x173;
    element_matrix[46] += x124 + x165 - x174;
    element_matrix[47] += x126 + x167 - x175;
    element_matrix[48] += x128 + x168 + x176;
    element_matrix[49] += x130 + x169 + x177;
    element_matrix[50] += x132 + x170 + x178;
    element_matrix[51] += x134 + x171 + x179;
    element_matrix[52] += x136 + x172 + x180;
    element_matrix[53] += x138 + x173 + x181;
    element_matrix[54] += x140 + x174 + x182;
    element_matrix[55] += x142 + x175 + x183;
    element_matrix[56] += x144 + x152 - x176;
    element_matrix[57] += x145 + x154 - x177;
    element_matrix[58] += x146 + x156 - x178;
    element_matrix[59] += x147 + x158 - x179;
    element_matrix[60] += x148 + x160 - x180;
    element_matrix[61] += x149 + x162 - x181;
    element_matrix[62] += x150 + x164 - x182;
    element_matrix[63] += x151 + x166 - x183;
}

//--------------------------
// hessian block_1_0
//--------------------------

template <typename scalar_t, typename accumulator_t>
static inline __host__ __device__ void cu_hex8_linear_elasticity_matrix_block_1_0(
        const scalar_t mu,
        const scalar_t lambda,
        const scalar_t *const SFEM_RESTRICT adjugate,
        const scalar_t jacobian_determinant,
        const scalar_t qx,
        const scalar_t qy,
        const scalar_t qz,
        const scalar_t qw,
        accumulator_t *const SFEM_RESTRICT element_matrix) {
    const scalar_t x0 = 1.0 / jacobian_determinant;
    const scalar_t x1 = 1 - qy;
    const scalar_t x2 = 1 - qz;
    const scalar_t x3 = x1 * x2;
    const scalar_t x4 = mu * qw;
    const scalar_t x5 = adjugate[1] * x4;
    const scalar_t x6 = x3 * x5;
    const scalar_t x7 = 1 - qx;
    const scalar_t x8 = x2 * x7;
    const scalar_t x9 = adjugate[4] * x4;
    const scalar_t x10 = x8 * x9;
    const scalar_t x11 = x1 * x7;
    const scalar_t x12 = adjugate[7] * x4;
    const scalar_t x13 = x11 * x12;
    const scalar_t x14 = x0 * (-x10 - x13 - x6);
    const scalar_t x15 = lambda * qw;
    const scalar_t x16 = adjugate[0] * x15;
    const scalar_t x17 = x16 * x3;
    const scalar_t x18 = adjugate[3] * x15;
    const scalar_t x19 = x18 * x8;
    const scalar_t x20 = adjugate[6] * x15;
    const scalar_t x21 = x11 * x20;
    const scalar_t x22 = x0 * (-x17 - x19 - x21);
    const scalar_t x23 = adjugate[6] * x14 + adjugate[7] * x22;
    const scalar_t x24 = x11 * x23;
    const scalar_t x25 = adjugate[3] * x14 + adjugate[4] * x22;
    const scalar_t x26 = x25 * x8;
    const scalar_t x27 = adjugate[0] * x14 + adjugate[1] * x22;
    const scalar_t x28 = x27 * x3;
    const scalar_t x29 = qx * x2;
    const scalar_t x30 = x29 * x9;
    const scalar_t x31 = qx * x1;
    const scalar_t x32 = x12 * x31;
    const scalar_t x33 = x0 * (-x30 - x32 + x6);
    const scalar_t x34 = x18 * x29;
    const scalar_t x35 = x20 * x31;
    const scalar_t x36 = x0 * (x17 - x34 - x35);
    const scalar_t x37 = adjugate[6] * x33 + adjugate[7] * x36;
    const scalar_t x38 = x11 * x37;
    const scalar_t x39 = adjugate[3] * x33 + adjugate[4] * x36;
    const scalar_t x40 = x39 * x8;
    const scalar_t x41 = adjugate[0] * x33 + adjugate[1] * x36;
    const scalar_t x42 = x3 * x41;
    const scalar_t x43 = qx * qy;
    const scalar_t x44 = x12 * x43;
    const scalar_t x45 = qy * x2;
    const scalar_t x46 = x45 * x5;
    const scalar_t x47 = x0 * (x30 - x44 + x46);
    const scalar_t x48 = x20 * x43;
    const scalar_t x49 = x16 * x45;
    const scalar_t x50 = x0 * (x34 - x48 + x49);
    const scalar_t x51 = adjugate[6] * x47 + adjugate[7] * x50;
    const scalar_t x52 = x11 * x51;
    const scalar_t x53 = adjugate[3] * x47 + adjugate[4] * x50;
    const scalar_t x54 = x53 * x8;
    const scalar_t x55 = adjugate[0] * x47 + adjugate[1] * x50;
    const scalar_t x56 = x3 * x55;
    const scalar_t x57 = qy * x7;
    const scalar_t x58 = x12 * x57;
    const scalar_t x59 = x0 * (x10 - x46 - x58);
    const scalar_t x60 = x20 * x57;
    const scalar_t x61 = x0 * (x19 - x49 - x60);
    const scalar_t x62 = adjugate[6] * x59 + adjugate[7] * x61;
    const scalar_t x63 = x11 * x62;
    const scalar_t x64 = adjugate[3] * x59 + adjugate[4] * x61;
    const scalar_t x65 = x64 * x8;
    const scalar_t x66 = adjugate[0] * x59 + adjugate[1] * x61;
    const scalar_t x67 = x3 * x66;
    const scalar_t x68 = qz * x1;
    const scalar_t x69 = x5 * x68;
    const scalar_t x70 = qz * x7;
    const scalar_t x71 = x70 * x9;
    const scalar_t x72 = x0 * (x13 - x69 - x71);
    const scalar_t x73 = x16 * x68;
    const scalar_t x74 = x18 * x70;
    const scalar_t x75 = x0 * (x21 - x73 - x74);
    const scalar_t x76 = adjugate[6] * x72 + adjugate[7] * x75;
    const scalar_t x77 = x11 * x76;
    const scalar_t x78 = adjugate[3] * x72 + adjugate[4] * x75;
    const scalar_t x79 = x78 * x8;
    const scalar_t x80 = adjugate[0] * x72 + adjugate[1] * x75;
    const scalar_t x81 = x3 * x80;
    const scalar_t x82 = qx * qz;
    const scalar_t x83 = x82 * x9;
    const scalar_t x84 = x0 * (x32 + x69 - x83);
    const scalar_t x85 = x18 * x82;
    const scalar_t x86 = x0 * (x35 + x73 - x85);
    const scalar_t x87 = adjugate[6] * x84 + adjugate[7] * x86;
    const scalar_t x88 = x11 * x87;
    const scalar_t x89 = adjugate[3] * x84 + adjugate[4] * x86;
    const scalar_t x90 = x8 * x89;
    const scalar_t x91 = adjugate[0] * x84 + adjugate[1] * x86;
    const scalar_t x92 = x3 * x91;
    const scalar_t x93 = qy * qz;
    const scalar_t x94 = x5 * x93;
    const scalar_t x95 = x0 * (x44 + x83 + x94);
    const scalar_t x96 = x16 * x93;
    const scalar_t x97 = x0 * (x48 + x85 + x96);
    const scalar_t x98 = adjugate[6] * x95 + adjugate[7] * x97;
    const scalar_t x99 = x11 * x98;
    const scalar_t x100 = adjugate[3] * x95 + adjugate[4] * x97;
    const scalar_t x101 = x100 * x8;
    const scalar_t x102 = adjugate[0] * x95 + adjugate[1] * x97;
    const scalar_t x103 = x102 * x3;
    const scalar_t x104 = x0 * (x58 + x71 - x94);
    const scalar_t x105 = x0 * (x60 + x74 - x96);
    const scalar_t x106 = adjugate[6] * x104 + adjugate[7] * x105;
    const scalar_t x107 = x106 * x11;
    const scalar_t x108 = adjugate[3] * x104 + adjugate[4] * x105;
    const scalar_t x109 = x108 * x8;
    const scalar_t x110 = adjugate[0] * x104 + adjugate[1] * x105;
    const scalar_t x111 = x110 * x3;
    const scalar_t x112 = x23 * x31;
    const scalar_t x113 = x25 * x29;
    const scalar_t x114 = x31 * x37;
    const scalar_t x115 = x29 * x39;
    const scalar_t x116 = x31 * x51;
    const scalar_t x117 = x29 * x53;
    const scalar_t x118 = x31 * x62;
    const scalar_t x119 = x29 * x64;
    const scalar_t x120 = x31 * x76;
    const scalar_t x121 = x29 * x78;
    const scalar_t x122 = x31 * x87;
    const scalar_t x123 = x29 * x89;
    const scalar_t x124 = x31 * x98;
    const scalar_t x125 = x100 * x29;
    const scalar_t x126 = x106 * x31;
    const scalar_t x127 = x108 * x29;
    const scalar_t x128 = x23 * x43;
    const scalar_t x129 = x27 * x45;
    const scalar_t x130 = x37 * x43;
    const scalar_t x131 = x41 * x45;
    const scalar_t x132 = x43 * x51;
    const scalar_t x133 = x45 * x55;
    const scalar_t x134 = x43 * x62;
    const scalar_t x135 = x45 * x66;
    const scalar_t x136 = x43 * x76;
    const scalar_t x137 = x45 * x80;
    const scalar_t x138 = x43 * x87;
    const scalar_t x139 = x45 * x91;
    const scalar_t x140 = x43 * x98;
    const scalar_t x141 = x102 * x45;
    const scalar_t x142 = x106 * x43;
    const scalar_t x143 = x110 * x45;
    const scalar_t x144 = x23 * x57;
    const scalar_t x145 = x37 * x57;
    const scalar_t x146 = x51 * x57;
    const scalar_t x147 = x57 * x62;
    const scalar_t x148 = x57 * x76;
    const scalar_t x149 = x57 * x87;
    const scalar_t x150 = x57 * x98;
    const scalar_t x151 = x106 * x57;
    const scalar_t x152 = x25 * x70;
    const scalar_t x153 = x27 * x68;
    const scalar_t x154 = x39 * x70;
    const scalar_t x155 = x41 * x68;
    const scalar_t x156 = x53 * x70;
    const scalar_t x157 = x55 * x68;
    const scalar_t x158 = x64 * x70;
    const scalar_t x159 = x66 * x68;
    const scalar_t x160 = x70 * x78;
    const scalar_t x161 = x68 * x80;
    const scalar_t x162 = x70 * x89;
    const scalar_t x163 = x68 * x91;
    const scalar_t x164 = x100 * x70;
    const scalar_t x165 = x102 * x68;
    const scalar_t x166 = x108 * x70;
    const scalar_t x167 = x110 * x68;
    const scalar_t x168 = x25 * x82;
    const scalar_t x169 = x39 * x82;
    const scalar_t x170 = x53 * x82;
    const scalar_t x171 = x64 * x82;
    const scalar_t x172 = x78 * x82;
    const scalar_t x173 = x82 * x89;
    const scalar_t x174 = x100 * x82;
    const scalar_t x175 = x108 * x82;
    const scalar_t x176 = x27 * x93;
    const scalar_t x177 = x41 * x93;
    const scalar_t x178 = x55 * x93;
    const scalar_t x179 = x66 * x93;
    const scalar_t x180 = x80 * x93;
    const scalar_t x181 = x91 * x93;
    const scalar_t x182 = x102 * x93;
    const scalar_t x183 = x110 * x93;
    element_matrix[0] += -x24 - x26 - x28;
    element_matrix[1] += -x38 - x40 - x42;
    element_matrix[2] += -x52 - x54 - x56;
    element_matrix[3] += -x63 - x65 - x67;
    element_matrix[4] += -x77 - x79 - x81;
    element_matrix[5] += -x88 - x90 - x92;
    element_matrix[6] += -x101 - x103 - x99;
    element_matrix[7] += -x107 - x109 - x111;
    element_matrix[8] += -x112 - x113 + x28;
    element_matrix[9] += -x114 - x115 + x42;
    element_matrix[10] += -x116 - x117 + x56;
    element_matrix[11] += -x118 - x119 + x67;
    element_matrix[12] += -x120 - x121 + x81;
    element_matrix[13] += -x122 - x123 + x92;
    element_matrix[14] += x103 - x124 - x125;
    element_matrix[15] += x111 - x126 - x127;
    element_matrix[16] += x113 - x128 + x129;
    element_matrix[17] += x115 - x130 + x131;
    element_matrix[18] += x117 - x132 + x133;
    element_matrix[19] += x119 - x134 + x135;
    element_matrix[20] += x121 - x136 + x137;
    element_matrix[21] += x123 - x138 + x139;
    element_matrix[22] += x125 - x140 + x141;
    element_matrix[23] += x127 - x142 + x143;
    element_matrix[24] += -x129 - x144 + x26;
    element_matrix[25] += -x131 - x145 + x40;
    element_matrix[26] += -x133 - x146 + x54;
    element_matrix[27] += -x135 - x147 + x65;
    element_matrix[28] += -x137 - x148 + x79;
    element_matrix[29] += -x139 - x149 + x90;
    element_matrix[30] += x101 - x141 - x150;
    element_matrix[31] += x109 - x143 - x151;
    element_matrix[32] += -x152 - x153 + x24;
    element_matrix[33] += -x154 - x155 + x38;
    element_matrix[34] += -x156 - x157 + x52;
    element_matrix[35] += -x158 - x159 + x63;
    element_matrix[36] += -x160 - x161 + x77;
    element_matrix[37] += -x162 - x163 + x88;
    element_matrix[38] += -x164 - x165 + x99;
    element_matrix[39] += x107 - x166 - x167;
    element_matrix[40] += x112 + x153 - x168;
    element_matrix[41] += x114 + x155 - x169;
    element_matrix[42] += x116 + x157 - x170;
    element_matrix[43] += x118 + x159 - x171;
    element_matrix[44] += x120 + x161 - x172;
    element_matrix[45] += x122 + x163 - x173;
    element_matrix[46] += x124 + x165 - x174;
    element_matrix[47] += x126 + x167 - x175;
    element_matrix[48] += x128 + x168 + x176;
    element_matrix[49] += x130 + x169 + x177;
    element_matrix[50] += x132 + x170 + x178;
    element_matrix[51] += x134 + x171 + x179;
    element_matrix[52] += x136 + x172 + x180;
    element_matrix[53] += x138 + x173 + x181;
    element_matrix[54] += x140 + x174 + x182;
    element_matrix[55] += x142 + x175 + x183;
    element_matrix[56] += x144 + x152 - x176;
    element_matrix[57] += x145 + x154 - x177;
    element_matrix[58] += x146 + x156 - x178;
    element_matrix[59] += x147 + x158 - x179;
    element_matrix[60] += x148 + x160 - x180;
    element_matrix[61] += x149 + x162 - x181;
    element_matrix[62] += x150 + x164 - x182;
    element_matrix[63] += x151 + x166 - x183;
}

//--------------------------
// hessian block_1_1
//--------------------------

template <typename scalar_t, typename accumulator_t>
static inline __host__ __device__ void cu_hex8_linear_elasticity_matrix_block_1_1(
        const scalar_t mu,
        const scalar_t lambda,
        const scalar_t *const SFEM_RESTRICT adjugate,
        const scalar_t jacobian_determinant,
        const scalar_t qx,
        const scalar_t qy,
        const scalar_t qz,
        const scalar_t qw,
        accumulator_t *const SFEM_RESTRICT element_matrix) {
    const scalar_t x0 = 1.0 / jacobian_determinant;
    const scalar_t x1 = 1 - qy;
    const scalar_t x2 = 1 - qz;
    const scalar_t x3 = x1 * x2;
    const scalar_t x4 = mu * qw;
    const scalar_t x5 = x3 * x4;
    const scalar_t x6 = adjugate[0] * x5;
    const scalar_t x7 = 1 - qx;
    const scalar_t x8 = x2 * x7;
    const scalar_t x9 = x4 * x8;
    const scalar_t x10 = adjugate[3] * x9;
    const scalar_t x11 = x1 * x7;
    const scalar_t x12 = x11 * x4;
    const scalar_t x13 = adjugate[6] * x12;
    const scalar_t x14 = x0 * (-x10 - x13 - x6);
    const scalar_t x15 = adjugate[2] * x5;
    const scalar_t x16 = adjugate[5] * x9;
    const scalar_t x17 = adjugate[8] * x12;
    const scalar_t x18 = x0 * (-x15 - x16 - x17);
    const scalar_t x19 = qw * (lambda + 2 * mu);
    const scalar_t x20 = adjugate[1] * x19;
    const scalar_t x21 = x20 * x3;
    const scalar_t x22 = adjugate[4] * x19;
    const scalar_t x23 = x22 * x8;
    const scalar_t x24 = adjugate[7] * x19;
    const scalar_t x25 = x11 * x24;
    const scalar_t x26 = x0 * (-x21 - x23 - x25);
    const scalar_t x27 = adjugate[6] * x14 + adjugate[7] * x26 + adjugate[8] * x18;
    const scalar_t x28 = x11 * x27;
    const scalar_t x29 = adjugate[3] * x14 + adjugate[4] * x26 + adjugate[5] * x18;
    const scalar_t x30 = x29 * x8;
    const scalar_t x31 = adjugate[0] * x14 + adjugate[1] * x26 + adjugate[2] * x18;
    const scalar_t x32 = x3 * x31;
    const scalar_t x33 = qx * x2;
    const scalar_t x34 = x33 * x4;
    const scalar_t x35 = adjugate[3] * x34;
    const scalar_t x36 = qx * x1;
    const scalar_t x37 = x36 * x4;
    const scalar_t x38 = adjugate[6] * x37;
    const scalar_t x39 = x0 * (-x35 - x38 + x6);
    const scalar_t x40 = adjugate[5] * x34;
    const scalar_t x41 = adjugate[8] * x37;
    const scalar_t x42 = x0 * (x15 - x40 - x41);
    const scalar_t x43 = x22 * x33;
    const scalar_t x44 = x24 * x36;
    const scalar_t x45 = x0 * (x21 - x43 - x44);
    const scalar_t x46 = adjugate[6] * x39 + adjugate[7] * x45 + adjugate[8] * x42;
    const scalar_t x47 = x11 * x46;
    const scalar_t x48 = adjugate[3] * x39 + adjugate[4] * x45 + adjugate[5] * x42;
    const scalar_t x49 = x48 * x8;
    const scalar_t x50 = adjugate[0] * x39 + adjugate[1] * x45 + adjugate[2] * x42;
    const scalar_t x51 = x3 * x50;
    const scalar_t x52 = qx * qy;
    const scalar_t x53 = x4 * x52;
    const scalar_t x54 = adjugate[6] * x53;
    const scalar_t x55 = qy * x2;
    const scalar_t x56 = x4 * x55;
    const scalar_t x57 = adjugate[0] * x56;
    const scalar_t x58 = x0 * (x35 - x54 + x57);
    const scalar_t x59 = adjugate[8] * x53;
    const scalar_t x60 = adjugate[2] * x56;
    const scalar_t x61 = x0 * (x40 - x59 + x60);
    const scalar_t x62 = x24 * x52;
    const scalar_t x63 = x20 * x55;
    const scalar_t x64 = x0 * (x43 - x62 + x63);
    const scalar_t x65 = adjugate[6] * x58 + adjugate[7] * x64 + adjugate[8] * x61;
    const scalar_t x66 = x11 * x65;
    const scalar_t x67 = adjugate[3] * x58 + adjugate[4] * x64 + adjugate[5] * x61;
    const scalar_t x68 = x67 * x8;
    const scalar_t x69 = adjugate[0] * x58 + adjugate[1] * x64 + adjugate[2] * x61;
    const scalar_t x70 = x3 * x69;
    const scalar_t x71 = qy * x7;
    const scalar_t x72 = x4 * x71;
    const scalar_t x73 = adjugate[6] * x72;
    const scalar_t x74 = x0 * (x10 - x57 - x73);
    const scalar_t x75 = adjugate[8] * x72;
    const scalar_t x76 = x0 * (x16 - x60 - x75);
    const scalar_t x77 = x24 * x71;
    const scalar_t x78 = x0 * (x23 - x63 - x77);
    const scalar_t x79 = adjugate[6] * x74 + adjugate[7] * x78 + adjugate[8] * x76;
    const scalar_t x80 = x11 * x79;
    const scalar_t x81 = adjugate[3] * x74 + adjugate[4] * x78 + adjugate[5] * x76;
    const scalar_t x82 = x8 * x81;
    const scalar_t x83 = adjugate[0] * x74 + adjugate[1] * x78 + adjugate[2] * x76;
    const scalar_t x84 = x3 * x83;
    const scalar_t x85 = qz * x1;
    const scalar_t x86 = x4 * x85;
    const scalar_t x87 = adjugate[0] * x86;
    const scalar_t x88 = qz * x7;
    const scalar_t x89 = x4 * x88;
    const scalar_t x90 = adjugate[3] * x89;
    const scalar_t x91 = x0 * (x13 - x87 - x90);
    const scalar_t x92 = adjugate[2] * x86;
    const scalar_t x93 = adjugate[5] * x89;
    const scalar_t x94 = x0 * (x17 - x92 - x93);
    const scalar_t x95 = x20 * x85;
    const scalar_t x96 = x22 * x88;
    const scalar_t x97 = x0 * (x25 - x95 - x96);
    const scalar_t x98 = adjugate[6] * x91 + adjugate[7] * x97 + adjugate[8] * x94;
    const scalar_t x99 = x11 * x98;
    const scalar_t x100 = adjugate[3] * x91 + adjugate[4] * x97 + adjugate[5] * x94;
    const scalar_t x101 = x100 * x8;
    const scalar_t x102 = adjugate[0] * x91 + adjugate[1] * x97 + adjugate[2] * x94;
    const scalar_t x103 = x102 * x3;
    const scalar_t x104 = qx * qz;
    const scalar_t x105 = x104 * x4;
    const scalar_t x106 = adjugate[3] * x105;
    const scalar_t x107 = x0 * (-x106 + x38 + x87);
    const scalar_t x108 = adjugate[5] * x105;
    const scalar_t x109 = x0 * (-x108 + x41 + x92);
    const scalar_t x110 = x104 * x22;
    const scalar_t x111 = x0 * (-x110 + x44 + x95);
    const scalar_t x112 = adjugate[6] * x107 + adjugate[7] * x111 + adjugate[8] * x109;
    const scalar_t x113 = x11 * x112;
    const scalar_t x114 = adjugate[3] * x107 + adjugate[4] * x111 + adjugate[5] * x109;
    const scalar_t x115 = x114 * x8;
    const scalar_t x116 = adjugate[0] * x107 + adjugate[1] * x111 + adjugate[2] * x109;
    const scalar_t x117 = x116 * x3;
    const scalar_t x118 = qy * qz;
    const scalar_t x119 = x118 * x4;
    const scalar_t x120 = adjugate[0] * x119;
    const scalar_t x121 = x0 * (x106 + x120 + x54);
    const scalar_t x122 = adjugate[2] * x119;
    const scalar_t x123 = x0 * (x108 + x122 + x59);
    const scalar_t x124 = x118 * x20;
    const scalar_t x125 = x0 * (x110 + x124 + x62);
    const scalar_t x126 = adjugate[6] * x121 + adjugate[7] * x125 + adjugate[8] * x123;
    const scalar_t x127 = x11 * x126;
    const scalar_t x128 = adjugate[3] * x121 + adjugate[4] * x125 + adjugate[5] * x123;
    const scalar_t x129 = x128 * x8;
    const scalar_t x130 = adjugate[0] * x121 + adjugate[1] * x125 + adjugate[2] * x123;
    const scalar_t x131 = x130 * x3;
    const scalar_t x132 = x0 * (-x120 + x73 + x90);
    const scalar_t x133 = x0 * (-x122 + x75 + x93);
    const scalar_t x134 = x0 * (-x124 + x77 + x96);
    const scalar_t x135 = adjugate[6] * x132 + adjugate[7] * x134 + adjugate[8] * x133;
    const scalar_t x136 = x11 * x135;
    const scalar_t x137 = adjugate[3] * x132 + adjugate[4] * x134 + adjugate[5] * x133;
    const scalar_t x138 = x137 * x8;
    const scalar_t x139 = adjugate[0] * x132 + adjugate[1] * x134 + adjugate[2] * x133;
    const scalar_t x140 = x139 * x3;
    const scalar_t x141 = x27 * x36;
    const scalar_t x142 = x29 * x33;
    const scalar_t x143 = x36 * x46;
    const scalar_t x144 = x33 * x48;
    const scalar_t x145 = x36 * x65;
    const scalar_t x146 = x33 * x67;
    const scalar_t x147 = x36 * x79;
    const scalar_t x148 = x33 * x81;
    const scalar_t x149 = x36 * x98;
    const scalar_t x150 = x100 * x33;
    const scalar_t x151 = x112 * x36;
    const scalar_t x152 = x114 * x33;
    const scalar_t x153 = x126 * x36;
    const scalar_t x154 = x128 * x33;
    const scalar_t x155 = x135 * x36;
    const scalar_t x156 = x137 * x33;
    const scalar_t x157 = x27 * x52;
    const scalar_t x158 = x31 * x55;
    const scalar_t x159 = x46 * x52;
    const scalar_t x160 = x50 * x55;
    const scalar_t x161 = x52 * x65;
    const scalar_t x162 = x55 * x69;
    const scalar_t x163 = x52 * x79;
    const scalar_t x164 = x55 * x83;
    const scalar_t x165 = x52 * x98;
    const scalar_t x166 = x102 * x55;
    const scalar_t x167 = x112 * x52;
    const scalar_t x168 = x116 * x55;
    const scalar_t x169 = x126 * x52;
    const scalar_t x170 = x130 * x55;
    const scalar_t x171 = x135 * x52;
    const scalar_t x172 = x139 * x55;
    const scalar_t x173 = x27 * x71;
    const scalar_t x174 = x46 * x71;
    const scalar_t x175 = x65 * x71;
    const scalar_t x176 = x71 * x79;
    const scalar_t x177 = x71 * x98;
    const scalar_t x178 = x112 * x71;
    const scalar_t x179 = x126 * x71;
    const scalar_t x180 = x135 * x71;
    const scalar_t x181 = x29 * x88;
    const scalar_t x182 = x31 * x85;
    const scalar_t x183 = x48 * x88;
    const scalar_t x184 = x50 * x85;
    const scalar_t x185 = x67 * x88;
    const scalar_t x186 = x69 * x85;
    const scalar_t x187 = x81 * x88;
    const scalar_t x188 = x83 * x85;
    const scalar_t x189 = x100 * x88;
    const scalar_t x190 = x102 * x85;
    const scalar_t x191 = x114 * x88;
    const scalar_t x192 = x116 * x85;
    const scalar_t x193 = x128 * x88;
    const scalar_t x194 = x130 * x85;
    const scalar_t x195 = x137 * x88;
    const scalar_t x196 = x139 * x85;
    const scalar_t x197 = x104 * x29;
    const scalar_t x198 = x104 * x48;
    const scalar_t x199 = x104 * x67;
    const scalar_t x200 = x104 * x81;
    const scalar_t x201 = x100 * x104;
    const scalar_t x202 = x104 * x114;
    const scalar_t x203 = x104 * x128;
    const scalar_t x204 = x104 * x137;
    const scalar_t x205 = x118 * x31;
    const scalar_t x206 = x118 * x50;
    const scalar_t x207 = x118 * x69;
    const scalar_t x208 = x118 * x83;
    const scalar_t x209 = x102 * x118;
    const scalar_t x210 = x116 * x118;
    const scalar_t x211 = x118 * x130;
    const scalar_t x212 = x118 * x139;
    element_matrix[0] += -x28 - x30 - x32;
    element_matrix[1] += -x47 - x49 - x51;
    element_matrix[2] += -x66 - x68 - x70;
    element_matrix[3] += -x80 - x82 - x84;
    element_matrix[4] += -x101 - x103 - x99;
    element_matrix[5] += -x113 - x115 - x117;
    element_matrix[6] += -x127 - x129 - x131;
    element_matrix[7] += -x136 - x138 - x140;
    element_matrix[8] += -x141 - x142 + x32;
    element_matrix[9] += -x143 - x144 + x51;
    element_matrix[10] += -x145 - x146 + x70;
    element_matrix[11] += -x147 - x148 + x84;
    element_matrix[12] += x103 - x149 - x150;
    element_matrix[13] += x117 - x151 - x152;
    element_matrix[14] += x131 - x153 - x154;
    element_matrix[15] += x140 - x155 - x156;
    element_matrix[16] += x142 - x157 + x158;
    element_matrix[17] += x144 - x159 + x160;
    element_matrix[18] += x146 - x161 + x162;
    element_matrix[19] += x148 - x163 + x164;
    element_matrix[20] += x150 - x165 + x166;
    element_matrix[21] += x152 - x167 + x168;
    element_matrix[22] += x154 - x169 + x170;
    element_matrix[23] += x156 - x171 + x172;
    element_matrix[24] += -x158 - x173 + x30;
    element_matrix[25] += -x160 - x174 + x49;
    element_matrix[26] += -x162 - x175 + x68;
    element_matrix[27] += -x164 - x176 + x82;
    element_matrix[28] += x101 - x166 - x177;
    element_matrix[29] += x115 - x168 - x178;
    element_matrix[30] += x129 - x170 - x179;
    element_matrix[31] += x138 - x172 - x180;
    element_matrix[32] += -x181 - x182 + x28;
    element_matrix[33] += -x183 - x184 + x47;
    element_matrix[34] += -x185 - x186 + x66;
    element_matrix[35] += -x187 - x188 + x80;
    element_matrix[36] += -x189 - x190 + x99;
    element_matrix[37] += x113 - x191 - x192;
    element_matrix[38] += x127 - x193 - x194;
    element_matrix[39] += x136 - x195 - x196;
    element_matrix[40] += x141 + x182 - x197;
    element_matrix[41] += x143 + x184 - x198;
    element_matrix[42] += x145 + x186 - x199;
    element_matrix[43] += x147 + x188 - x200;
    element_matrix[44] += x149 + x190 - x201;
    element_matrix[45] += x151 + x192 - x202;
    element_matrix[46] += x153 + x194 - x203;
    element_matrix[47] += x155 + x196 - x204;
    element_matrix[48] += x157 + x197 + x205;
    element_matrix[49] += x159 + x198 + x206;
    element_matrix[50] += x161 + x199 + x207;
    element_matrix[51] += x163 + x200 + x208;
    element_matrix[52] += x165 + x201 + x209;
    element_matrix[53] += x167 + x202 + x210;
    element_matrix[54] += x169 + x203 + x211;
    element_matrix[55] += x171 + x204 + x212;
    element_matrix[56] += x173 + x181 - x205;
    element_matrix[57] += x174 + x183 - x206;
    element_matrix[58] += x175 + x185 - x207;
    element_matrix[59] += x176 + x187 - x208;
    element_matrix[60] += x177 + x189 - x209;
    element_matrix[61] += x178 + x191 - x210;
    element_matrix[62] += x179 + x193 - x211;
    element_matrix[63] += x180 + x195 - x212;
}

//--------------------------
// hessian block_1_2
//--------------------------

template <typename scalar_t, typename accumulator_t>
static inline __host__ __device__ void cu_hex8_linear_elasticity_matrix_block_1_2(
        const scalar_t mu,
        const scalar_t lambda,
        const scalar_t *const SFEM_RESTRICT adjugate,
        const scalar_t jacobian_determinant,
        const scalar_t qx,
        const scalar_t qy,
        const scalar_t qz,
        const scalar_t qw,
        accumulator_t *const SFEM_RESTRICT element_matrix) {
    const scalar_t x0 = 1.0 / jacobian_determinant;
    const scalar_t x1 = 1 - qy;
    const scalar_t x2 = 1 - qz;
    const scalar_t x3 = x1 * x2;
    const scalar_t x4 = lambda * qw;
    const scalar_t x5 = adjugate[2] * x4;
    const scalar_t x6 = x3 * x5;
    const scalar_t x7 = 1 - qx;
    const scalar_t x8 = x2 * x7;
    const scalar_t x9 = adjugate[5] * x4;
    const scalar_t x10 = x8 * x9;
    const scalar_t x11 = x1 * x7;
    const scalar_t x12 = adjugate[8] * x4;
    const scalar_t x13 = x11 * x12;
    const scalar_t x14 = x0 * (-x10 - x13 - x6);
    const scalar_t x15 = mu * qw;
    const scalar_t x16 = adjugate[1] * x15;
    const scalar_t x17 = x16 * x3;
    const scalar_t x18 = adjugate[4] * x15;
    const scalar_t x19 = x18 * x8;
    const scalar_t x20 = adjugate[7] * x15;
    const scalar_t x21 = x11 * x20;
    const scalar_t x22 = x0 * (-x17 - x19 - x21);
    const scalar_t x23 = adjugate[7] * x14 + adjugate[8] * x22;
    const scalar_t x24 = x11 * x23;
    const scalar_t x25 = adjugate[4] * x14 + adjugate[5] * x22;
    const scalar_t x26 = x25 * x8;
    const scalar_t x27 = adjugate[1] * x14 + adjugate[2] * x22;
    const scalar_t x28 = x27 * x3;
    const scalar_t x29 = qx * x2;
    const scalar_t x30 = x29 * x9;
    const scalar_t x31 = qx * x1;
    const scalar_t x32 = x12 * x31;
    const scalar_t x33 = x0 * (-x30 - x32 + x6);
    const scalar_t x34 = x18 * x29;
    const scalar_t x35 = x20 * x31;
    const scalar_t x36 = x0 * (x17 - x34 - x35);
    const scalar_t x37 = adjugate[7] * x33 + adjugate[8] * x36;
    const scalar_t x38 = x11 * x37;
    const scalar_t x39 = adjugate[4] * x33 + adjugate[5] * x36;
    const scalar_t x40 = x39 * x8;
    const scalar_t x41 = adjugate[1] * x33 + adjugate[2] * x36;
    const scalar_t x42 = x3 * x41;
    const scalar_t x43 = qx * qy;
    const scalar_t x44 = x12 * x43;
    const scalar_t x45 = qy * x2;
    const scalar_t x46 = x45 * x5;
    const scalar_t x47 = x0 * (x30 - x44 + x46);
    const scalar_t x48 = x20 * x43;
    const scalar_t x49 = x16 * x45;
    const scalar_t x50 = x0 * (x34 - x48 + x49);
    const scalar_t x51 = adjugate[7] * x47 + adjugate[8] * x50;
    const scalar_t x52 = x11 * x51;
    const scalar_t x53 = adjugate[4] * x47 + adjugate[5] * x50;
    const scalar_t x54 = x53 * x8;
    const scalar_t x55 = adjugate[1] * x47 + adjugate[2] * x50;
    const scalar_t x56 = x3 * x55;
    const scalar_t x57 = qy * x7;
    const scalar_t x58 = x12 * x57;
    const scalar_t x59 = x0 * (x10 - x46 - x58);
    const scalar_t x60 = x20 * x57;
    const scalar_t x61 = x0 * (x19 - x49 - x60);
    const scalar_t x62 = adjugate[7] * x59 + adjugate[8] * x61;
    const scalar_t x63 = x11 * x62;
    const scalar_t x64 = adjugate[4] * x59 + adjugate[5] * x61;
    const scalar_t x65 = x64 * x8;
    const scalar_t x66 = adjugate[1] * x59 + adjugate[2] * x61;
    const scalar_t x67 = x3 * x66;
    const scalar_t x68 = qz * x1;
    const scalar_t x69 = x5 * x68;
    const scalar_t x70 = qz * x7;
    const scalar_t x71 = x70 * x9;
    const scalar_t x72 = x0 * (x13 - x69 - x71);
    const scalar_t x73 = x16 * x68;
    const scalar_t x74 = x18 * x70;
    const scalar_t x75 = x0 * (x21 - x73 - x74);
    const scalar_t x76 = adjugate[7] * x72 + adjugate[8] * x75;
    const scalar_t x77 = x11 * x76;
    const scalar_t x78 = adjugate[4] * x72 + adjugate[5] * x75;
    const scalar_t x79 = x78 * x8;
    const scalar_t x80 = adjugate[1] * x72 + adjugate[2] * x75;
    const scalar_t x81 = x3 * x80;
    const scalar_t x82 = qx * qz;
    const scalar_t x83 = x82 * x9;
    const scalar_t x84 = x0 * (x32 + x69 - x83);
    const scalar_t x85 = x18 * x82;
    const scalar_t x86 = x0 * (x35 + x73 - x85);
    const scalar_t x87 = adjugate[7] * x84 + adjugate[8] * x86;
    const scalar_t x88 = x11 * x87;
    const scalar_t x89 = adjugate[4] * x84 + adjugate[5] * x86;
    const scalar_t x90 = x8 * x89;
    const scalar_t x91 = adjugate[1] * x84 + adjugate[2] * x86;
    const scalar_t x92 = x3 * x91;
    const scalar_t x93 = qy * qz;
    const scalar_t x94 = x5 * x93;
    const scalar_t x95 = x0 * (x44 + x83 + x94);
    const scalar_t x96 = x16 * x93;
    const scalar_t x97 = x0 * (x48 + x85 + x96);
    const scalar_t x98 = adjugate[7] * x95 + adjugate[8] * x97;
    const scalar_t x99 = x11 * x98;
    const scalar_t x100 = adjugate[4] * x95 + adjugate[5] * x97;
    const scalar_t x101 = x100 * x8;
    const scalar_t x102 = adjugate[1] * x95 + adjugate[2] * x97;
    const scalar_t x103 = x102 * x3;
    const scalar_t x104 = x0 * (x58 + x71 - x94);
    const scalar_t x105 = x0 * (x60 + x74 - x96);
    const scalar_t x106 = adjugate[7] * x104 + adjugate[8] * x105;
    const scalar_t x107 = x106 * x11;
    const scalar_t x108 = adjugate[4] * x104 + adjugate[5] * x105;
    const scalar_t x109 = x108 * x8;
    const scalar_t x110 = adjugate[1] * x104 + adjugate[2] * x105;
    const scalar_t x111 = x110 * x3;
    const scalar_t x112 = x23 * x31;
    const scalar_t x113 = x25 * x29;
    const scalar_t x114 = x31 * x37;
    const scalar_t x115 = x29 * x39;
    const scalar_t x116 = x31 * x51;
    const scalar_t x117 = x29 * x53;
    const scalar_t x118 = x31 * x62;
    const scalar_t x119 = x29 * x64;
    const scalar_t x120 = x31 * x76;
    const scalar_t x121 = x29 * x78;
    const scalar_t x122 = x31 * x87;
    const scalar_t x123 = x29 * x89;
    const scalar_t x124 = x31 * x98;
    const scalar_t x125 = x100 * x29;
    const scalar_t x126 = x106 * x31;
    const scalar_t x127 = x108 * x29;
    const scalar_t x128 = x23 * x43;
    const scalar_t x129 = x27 * x45;
    const scalar_t x130 = x37 * x43;
    const scalar_t x131 = x41 * x45;
    const scalar_t x132 = x43 * x51;
    const scalar_t x133 = x45 * x55;
    const scalar_t x134 = x43 * x62;
    const scalar_t x135 = x45 * x66;
    const scalar_t x136 = x43 * x76;
    const scalar_t x137 = x45 * x80;
    const scalar_t x138 = x43 * x87;
    const scalar_t x139 = x45 * x91;
    const scalar_t x140 = x43 * x98;
    const scalar_t x141 = x102 * x45;
    const scalar_t x142 = x106 * x43;
    const scalar_t x143 = x110 * x45;
    const scalar_t x144 = x23 * x57;
    const scalar_t x145 = x37 * x57;
    const scalar_t x146 = x51 * x57;
    const scalar_t x147 = x57 * x62;
    const scalar_t x148 = x57 * x76;
    const scalar_t x149 = x57 * x87;
    const scalar_t x150 = x57 * x98;
    const scalar_t x151 = x106 * x57;
    const scalar_t x152 = x25 * x70;
    const scalar_t x153 = x27 * x68;
    const scalar_t x154 = x39 * x70;
    const scalar_t x155 = x41 * x68;
    const scalar_t x156 = x53 * x70;
    const scalar_t x157 = x55 * x68;
    const scalar_t x158 = x64 * x70;
    const scalar_t x159 = x66 * x68;
    const scalar_t x160 = x70 * x78;
    const scalar_t x161 = x68 * x80;
    const scalar_t x162 = x70 * x89;
    const scalar_t x163 = x68 * x91;
    const scalar_t x164 = x100 * x70;
    const scalar_t x165 = x102 * x68;
    const scalar_t x166 = x108 * x70;
    const scalar_t x167 = x110 * x68;
    const scalar_t x168 = x25 * x82;
    const scalar_t x169 = x39 * x82;
    const scalar_t x170 = x53 * x82;
    const scalar_t x171 = x64 * x82;
    const scalar_t x172 = x78 * x82;
    const scalar_t x173 = x82 * x89;
    const scalar_t x174 = x100 * x82;
    const scalar_t x175 = x108 * x82;
    const scalar_t x176 = x27 * x93;
    const scalar_t x177 = x41 * x93;
    const scalar_t x178 = x55 * x93;
    const scalar_t x179 = x66 * x93;
    const scalar_t x180 = x80 * x93;
    const scalar_t x181 = x91 * x93;
    const scalar_t x182 = x102 * x93;
    const scalar_t x183 = x110 * x93;
    element_matrix[0] += -x24 - x26 - x28;
    element_matrix[1] += -x38 - x40 - x42;
    element_matrix[2] += -x52 - x54 - x56;
    element_matrix[3] += -x63 - x65 - x67;
    element_matrix[4] += -x77 - x79 - x81;
    element_matrix[5] += -x88 - x90 - x92;
    element_matrix[6] += -x101 - x103 - x99;
    element_matrix[7] += -x107 - x109 - x111;
    element_matrix[8] += -x112 - x113 + x28;
    element_matrix[9] += -x114 - x115 + x42;
    element_matrix[10] += -x116 - x117 + x56;
    element_matrix[11] += -x118 - x119 + x67;
    element_matrix[12] += -x120 - x121 + x81;
    element_matrix[13] += -x122 - x123 + x92;
    element_matrix[14] += x103 - x124 - x125;
    element_matrix[15] += x111 - x126 - x127;
    element_matrix[16] += x113 - x128 + x129;
    element_matrix[17] += x115 - x130 + x131;
    element_matrix[18] += x117 - x132 + x133;
    element_matrix[19] += x119 - x134 + x135;
    element_matrix[20] += x121 - x136 + x137;
    element_matrix[21] += x123 - x138 + x139;
    element_matrix[22] += x125 - x140 + x141;
    element_matrix[23] += x127 - x142 + x143;
    element_matrix[24] += -x129 - x144 + x26;
    element_matrix[25] += -x131 - x145 + x40;
    element_matrix[26] += -x133 - x146 + x54;
    element_matrix[27] += -x135 - x147 + x65;
    element_matrix[28] += -x137 - x148 + x79;
    element_matrix[29] += -x139 - x149 + x90;
    element_matrix[30] += x101 - x141 - x150;
    element_matrix[31] += x109 - x143 - x151;
    element_matrix[32] += -x152 - x153 + x24;
    element_matrix[33] += -x154 - x155 + x38;
    element_matrix[34] += -x156 - x157 + x52;
    element_matrix[35] += -x158 - x159 + x63;
    element_matrix[36] += -x160 - x161 + x77;
    element_matrix[37] += -x162 - x163 + x88;
    element_matrix[38] += -x164 - x165 + x99;
    element_matrix[39] += x107 - x166 - x167;
    element_matrix[40] += x112 + x153 - x168;
    element_matrix[41] += x114 + x155 - x169;
    element_matrix[42] += x116 + x157 - x170;
    element_matrix[43] += x118 + x159 - x171;
    element_matrix[44] += x120 + x161 - x172;
    element_matrix[45] += x122 + x163 - x173;
    element_matrix[46] += x124 + x165 - x174;
    element_matrix[47] += x126 + x167 - x175;
    element_matrix[48] += x128 + x168 + x176;
    element_matrix[49] += x130 + x169 + x177;
    element_matrix[50] += x132 + x170 + x178;
    element_matrix[51] += x134 + x171 + x179;
    element_matrix[52] += x136 + x172 + x180;
    element_matrix[53] += x138 + x173 + x181;
    element_matrix[54] += x140 + x174 + x182;
    element_matrix[55] += x142 + x175 + x183;
    element_matrix[56] += x144 + x152 - x176;
    element_matrix[57] += x145 + x154 - x177;
    element_matrix[58] += x146 + x156 - x178;
    element_matrix[59] += x147 + x158 - x179;
    element_matrix[60] += x148 + x160 - x180;
    element_matrix[61] += x149 + x162 - x181;
    element_matrix[62] += x150 + x164 - x182;
    element_matrix[63] += x151 + x166 - x183;
}

//--------------------------
// hessian block_2_0
//--------------------------

template <typename scalar_t, typename accumulator_t>
static inline __host__ __device__ void cu_hex8_linear_elasticity_matrix_block_2_0(
        const scalar_t mu,
        const scalar_t lambda,
        const scalar_t *const SFEM_RESTRICT adjugate,
        const scalar_t jacobian_determinant,
        const scalar_t qx,
        const scalar_t qy,
        const scalar_t qz,
        const scalar_t qw,
        accumulator_t *const SFEM_RESTRICT element_matrix) {
    const scalar_t x0 = 1.0 / jacobian_determinant;
    const scalar_t x1 = 1 - qy;
    const scalar_t x2 = 1 - qz;
    const scalar_t x3 = x1 * x2;
    const scalar_t x4 = mu * qw;
    const scalar_t x5 = adjugate[2] * x4;
    const scalar_t x6 = x3 * x5;
    const scalar_t x7 = 1 - qx;
    const scalar_t x8 = x2 * x7;
    const scalar_t x9 = adjugate[5] * x4;
    const scalar_t x10 = x8 * x9;
    const scalar_t x11 = x1 * x7;
    const scalar_t x12 = adjugate[8] * x4;
    const scalar_t x13 = x11 * x12;
    const scalar_t x14 = x0 * (-x10 - x13 - x6);
    const scalar_t x15 = lambda * qw;
    const scalar_t x16 = adjugate[0] * x15;
    const scalar_t x17 = x16 * x3;
    const scalar_t x18 = adjugate[3] * x15;
    const scalar_t x19 = x18 * x8;
    const scalar_t x20 = adjugate[6] * x15;
    const scalar_t x21 = x11 * x20;
    const scalar_t x22 = x0 * (-x17 - x19 - x21);
    const scalar_t x23 = adjugate[6] * x14 + adjugate[8] * x22;
    const scalar_t x24 = x11 * x23;
    const scalar_t x25 = adjugate[3] * x14 + adjugate[5] * x22;
    const scalar_t x26 = x25 * x8;
    const scalar_t x27 = adjugate[0] * x14 + adjugate[2] * x22;
    const scalar_t x28 = x27 * x3;
    const scalar_t x29 = qx * x2;
    const scalar_t x30 = x29 * x9;
    const scalar_t x31 = qx * x1;
    const scalar_t x32 = x12 * x31;
    const scalar_t x33 = x0 * (-x30 - x32 + x6);
    const scalar_t x34 = x18 * x29;
    const scalar_t x35 = x20 * x31;
    const scalar_t x36 = x0 * (x17 - x34 - x35);
    const scalar_t x37 = adjugate[6] * x33 + adjugate[8] * x36;
    const scalar_t x38 = x11 * x37;
    const scalar_t x39 = adjugate[3] * x33 + adjugate[5] * x36;
    const scalar_t x40 = x39 * x8;
    const scalar_t x41 = adjugate[0] * x33 + adjugate[2] * x36;
    const scalar_t x42 = x3 * x41;
    const scalar_t x43 = qx * qy;
    const scalar_t x44 = x12 * x43;
    const scalar_t x45 = qy * x2;
    const scalar_t x46 = x45 * x5;
    const scalar_t x47 = x0 * (x30 - x44 + x46);
    const scalar_t x48 = x20 * x43;
    const scalar_t x49 = x16 * x45;
    const scalar_t x50 = x0 * (x34 - x48 + x49);
    const scalar_t x51 = adjugate[6] * x47 + adjugate[8] * x50;
    const scalar_t x52 = x11 * x51;
    const scalar_t x53 = adjugate[3] * x47 + adjugate[5] * x50;
    const scalar_t x54 = x53 * x8;
    const scalar_t x55 = adjugate[0] * x47 + adjugate[2] * x50;
    const scalar_t x56 = x3 * x55;
    const scalar_t x57 = qy * x7;
    const scalar_t x58 = x12 * x57;
    const scalar_t x59 = x0 * (x10 - x46 - x58);
    const scalar_t x60 = x20 * x57;
    const scalar_t x61 = x0 * (x19 - x49 - x60);
    const scalar_t x62 = adjugate[6] * x59 + adjugate[8] * x61;
    const scalar_t x63 = x11 * x62;
    const scalar_t x64 = adjugate[3] * x59 + adjugate[5] * x61;
    const scalar_t x65 = x64 * x8;
    const scalar_t x66 = adjugate[0] * x59 + adjugate[2] * x61;
    const scalar_t x67 = x3 * x66;
    const scalar_t x68 = qz * x1;
    const scalar_t x69 = x5 * x68;
    const scalar_t x70 = qz * x7;
    const scalar_t x71 = x70 * x9;
    const scalar_t x72 = x0 * (x13 - x69 - x71);
    const scalar_t x73 = x16 * x68;
    const scalar_t x74 = x18 * x70;
    const scalar_t x75 = x0 * (x21 - x73 - x74);
    const scalar_t x76 = adjugate[6] * x72 + adjugate[8] * x75;
    const scalar_t x77 = x11 * x76;
    const scalar_t x78 = adjugate[3] * x72 + adjugate[5] * x75;
    const scalar_t x79 = x78 * x8;
    const scalar_t x80 = adjugate[0] * x72 + adjugate[2] * x75;
    const scalar_t x81 = x3 * x80;
    const scalar_t x82 = qx * qz;
    const scalar_t x83 = x82 * x9;
    const scalar_t x84 = x0 * (x32 + x69 - x83);
    const scalar_t x85 = x18 * x82;
    const scalar_t x86 = x0 * (x35 + x73 - x85);
    const scalar_t x87 = adjugate[6] * x84 + adjugate[8] * x86;
    const scalar_t x88 = x11 * x87;
    const scalar_t x89 = adjugate[3] * x84 + adjugate[5] * x86;
    const scalar_t x90 = x8 * x89;
    const scalar_t x91 = adjugate[0] * x84 + adjugate[2] * x86;
    const scalar_t x92 = x3 * x91;
    const scalar_t x93 = qy * qz;
    const scalar_t x94 = x5 * x93;
    const scalar_t x95 = x0 * (x44 + x83 + x94);
    const scalar_t x96 = x16 * x93;
    const scalar_t x97 = x0 * (x48 + x85 + x96);
    const scalar_t x98 = adjugate[6] * x95 + adjugate[8] * x97;
    const scalar_t x99 = x11 * x98;
    const scalar_t x100 = adjugate[3] * x95 + adjugate[5] * x97;
    const scalar_t x101 = x100 * x8;
    const scalar_t x102 = adjugate[0] * x95 + adjugate[2] * x97;
    const scalar_t x103 = x102 * x3;
    const scalar_t x104 = x0 * (x58 + x71 - x94);
    const scalar_t x105 = x0 * (x60 + x74 - x96);
    const scalar_t x106 = adjugate[6] * x104 + adjugate[8] * x105;
    const scalar_t x107 = x106 * x11;
    const scalar_t x108 = adjugate[3] * x104 + adjugate[5] * x105;
    const scalar_t x109 = x108 * x8;
    const scalar_t x110 = adjugate[0] * x104 + adjugate[2] * x105;
    const scalar_t x111 = x110 * x3;
    const scalar_t x112 = x23 * x31;
    const scalar_t x113 = x25 * x29;
    const scalar_t x114 = x31 * x37;
    const scalar_t x115 = x29 * x39;
    const scalar_t x116 = x31 * x51;
    const scalar_t x117 = x29 * x53;
    const scalar_t x118 = x31 * x62;
    const scalar_t x119 = x29 * x64;
    const scalar_t x120 = x31 * x76;
    const scalar_t x121 = x29 * x78;
    const scalar_t x122 = x31 * x87;
    const scalar_t x123 = x29 * x89;
    const scalar_t x124 = x31 * x98;
    const scalar_t x125 = x100 * x29;
    const scalar_t x126 = x106 * x31;
    const scalar_t x127 = x108 * x29;
    const scalar_t x128 = x23 * x43;
    const scalar_t x129 = x27 * x45;
    const scalar_t x130 = x37 * x43;
    const scalar_t x131 = x41 * x45;
    const scalar_t x132 = x43 * x51;
    const scalar_t x133 = x45 * x55;
    const scalar_t x134 = x43 * x62;
    const scalar_t x135 = x45 * x66;
    const scalar_t x136 = x43 * x76;
    const scalar_t x137 = x45 * x80;
    const scalar_t x138 = x43 * x87;
    const scalar_t x139 = x45 * x91;
    const scalar_t x140 = x43 * x98;
    const scalar_t x141 = x102 * x45;
    const scalar_t x142 = x106 * x43;
    const scalar_t x143 = x110 * x45;
    const scalar_t x144 = x23 * x57;
    const scalar_t x145 = x37 * x57;
    const scalar_t x146 = x51 * x57;
    const scalar_t x147 = x57 * x62;
    const scalar_t x148 = x57 * x76;
    const scalar_t x149 = x57 * x87;
    const scalar_t x150 = x57 * x98;
    const scalar_t x151 = x106 * x57;
    const scalar_t x152 = x25 * x70;
    const scalar_t x153 = x27 * x68;
    const scalar_t x154 = x39 * x70;
    const scalar_t x155 = x41 * x68;
    const scalar_t x156 = x53 * x70;
    const scalar_t x157 = x55 * x68;
    const scalar_t x158 = x64 * x70;
    const scalar_t x159 = x66 * x68;
    const scalar_t x160 = x70 * x78;
    const scalar_t x161 = x68 * x80;
    const scalar_t x162 = x70 * x89;
    const scalar_t x163 = x68 * x91;
    const scalar_t x164 = x100 * x70;
    const scalar_t x165 = x102 * x68;
    const scalar_t x166 = x108 * x70;
    const scalar_t x167 = x110 * x68;
    const scalar_t x168 = x25 * x82;
    const scalar_t x169 = x39 * x82;
    const scalar_t x170 = x53 * x82;
    const scalar_t x171 = x64 * x82;
    const scalar_t x172 = x78 * x82;
    const scalar_t x173 = x82 * x89;
    const scalar_t x174 = x100 * x82;
    const scalar_t x175 = x108 * x82;
    const scalar_t x176 = x27 * x93;
    const scalar_t x177 = x41 * x93;
    const scalar_t x178 = x55 * x93;
    const scalar_t x179 = x66 * x93;
    const scalar_t x180 = x80 * x93;
    const scalar_t x181 = x91 * x93;
    const scalar_t x182 = x102 * x93;
    const scalar_t x183 = x110 * x93;
    element_matrix[0] += -x24 - x26 - x28;
    element_matrix[1] += -x38 - x40 - x42;
    element_matrix[2] += -x52 - x54 - x56;
    element_matrix[3] += -x63 - x65 - x67;
    element_matrix[4] += -x77 - x79 - x81;
    element_matrix[5] += -x88 - x90 - x92;
    element_matrix[6] += -x101 - x103 - x99;
    element_matrix[7] += -x107 - x109 - x111;
    element_matrix[8] += -x112 - x113 + x28;
    element_matrix[9] += -x114 - x115 + x42;
    element_matrix[10] += -x116 - x117 + x56;
    element_matrix[11] += -x118 - x119 + x67;
    element_matrix[12] += -x120 - x121 + x81;
    element_matrix[13] += -x122 - x123 + x92;
    element_matrix[14] += x103 - x124 - x125;
    element_matrix[15] += x111 - x126 - x127;
    element_matrix[16] += x113 - x128 + x129;
    element_matrix[17] += x115 - x130 + x131;
    element_matrix[18] += x117 - x132 + x133;
    element_matrix[19] += x119 - x134 + x135;
    element_matrix[20] += x121 - x136 + x137;
    element_matrix[21] += x123 - x138 + x139;
    element_matrix[22] += x125 - x140 + x141;
    element_matrix[23] += x127 - x142 + x143;
    element_matrix[24] += -x129 - x144 + x26;
    element_matrix[25] += -x131 - x145 + x40;
    element_matrix[26] += -x133 - x146 + x54;
    element_matrix[27] += -x135 - x147 + x65;
    element_matrix[28] += -x137 - x148 + x79;
    element_matrix[29] += -x139 - x149 + x90;
    element_matrix[30] += x101 - x141 - x150;
    element_matrix[31] += x109 - x143 - x151;
    element_matrix[32] += -x152 - x153 + x24;
    element_matrix[33] += -x154 - x155 + x38;
    element_matrix[34] += -x156 - x157 + x52;
    element_matrix[35] += -x158 - x159 + x63;
    element_matrix[36] += -x160 - x161 + x77;
    element_matrix[37] += -x162 - x163 + x88;
    element_matrix[38] += -x164 - x165 + x99;
    element_matrix[39] += x107 - x166 - x167;
    element_matrix[40] += x112 + x153 - x168;
    element_matrix[41] += x114 + x155 - x169;
    element_matrix[42] += x116 + x157 - x170;
    element_matrix[43] += x118 + x159 - x171;
    element_matrix[44] += x120 + x161 - x172;
    element_matrix[45] += x122 + x163 - x173;
    element_matrix[46] += x124 + x165 - x174;
    element_matrix[47] += x126 + x167 - x175;
    element_matrix[48] += x128 + x168 + x176;
    element_matrix[49] += x130 + x169 + x177;
    element_matrix[50] += x132 + x170 + x178;
    element_matrix[51] += x134 + x171 + x179;
    element_matrix[52] += x136 + x172 + x180;
    element_matrix[53] += x138 + x173 + x181;
    element_matrix[54] += x140 + x174 + x182;
    element_matrix[55] += x142 + x175 + x183;
    element_matrix[56] += x144 + x152 - x176;
    element_matrix[57] += x145 + x154 - x177;
    element_matrix[58] += x146 + x156 - x178;
    element_matrix[59] += x147 + x158 - x179;
    element_matrix[60] += x148 + x160 - x180;
    element_matrix[61] += x149 + x162 - x181;
    element_matrix[62] += x150 + x164 - x182;
    element_matrix[63] += x151 + x166 - x183;
}

//--------------------------
// hessian block_2_1
//--------------------------

template <typename scalar_t, typename accumulator_t>
static inline __host__ __device__ void cu_hex8_linear_elasticity_matrix_block_2_1(
        const scalar_t mu,
        const scalar_t lambda,
        const scalar_t *const SFEM_RESTRICT adjugate,
        const scalar_t jacobian_determinant,
        const scalar_t qx,
        const scalar_t qy,
        const scalar_t qz,
        const scalar_t qw,
        accumulator_t *const SFEM_RESTRICT element_matrix) {
    const scalar_t x0 = 1.0 / jacobian_determinant;
    const scalar_t x1 = 1 - qy;
    const scalar_t x2 = 1 - qz;
    const scalar_t x3 = x1 * x2;
    const scalar_t x4 = mu * qw;
    const scalar_t x5 = adjugate[2] * x4;
    const scalar_t x6 = x3 * x5;
    const scalar_t x7 = 1 - qx;
    const scalar_t x8 = x2 * x7;
    const scalar_t x9 = adjugate[5] * x4;
    const scalar_t x10 = x8 * x9;
    const scalar_t x11 = x1 * x7;
    const scalar_t x12 = adjugate[8] * x4;
    const scalar_t x13 = x11 * x12;
    const scalar_t x14 = x0 * (-x10 - x13 - x6);
    const scalar_t x15 = lambda * qw;
    const scalar_t x16 = adjugate[1] * x15;
    const scalar_t x17 = x16 * x3;
    const scalar_t x18 = adjugate[4] * x15;
    const scalar_t x19 = x18 * x8;
    const scalar_t x20 = adjugate[7] * x15;
    const scalar_t x21 = x11 * x20;
    const scalar_t x22 = x0 * (-x17 - x19 - x21);
    const scalar_t x23 = adjugate[7] * x14 + adjugate[8] * x22;
    const scalar_t x24 = x11 * x23;
    const scalar_t x25 = adjugate[4] * x14 + adjugate[5] * x22;
    const scalar_t x26 = x25 * x8;
    const scalar_t x27 = adjugate[1] * x14 + adjugate[2] * x22;
    const scalar_t x28 = x27 * x3;
    const scalar_t x29 = qx * x2;
    const scalar_t x30 = x29 * x9;
    const scalar_t x31 = qx * x1;
    const scalar_t x32 = x12 * x31;
    const scalar_t x33 = x0 * (-x30 - x32 + x6);
    const scalar_t x34 = x18 * x29;
    const scalar_t x35 = x20 * x31;
    const scalar_t x36 = x0 * (x17 - x34 - x35);
    const scalar_t x37 = adjugate[7] * x33 + adjugate[8] * x36;
    const scalar_t x38 = x11 * x37;
    const scalar_t x39 = adjugate[4] * x33 + adjugate[5] * x36;
    const scalar_t x40 = x39 * x8;
    const scalar_t x41 = adjugate[1] * x33 + adjugate[2] * x36;
    const scalar_t x42 = x3 * x41;
    const scalar_t x43 = qx * qy;
    const scalar_t x44 = x12 * x43;
    const scalar_t x45 = qy * x2;
    const scalar_t x46 = x45 * x5;
    const scalar_t x47 = x0 * (x30 - x44 + x46);
    const scalar_t x48 = x20 * x43;
    const scalar_t x49 = x16 * x45;
    const scalar_t x50 = x0 * (x34 - x48 + x49);
    const scalar_t x51 = adjugate[7] * x47 + adjugate[8] * x50;
    const scalar_t x52 = x11 * x51;
    const scalar_t x53 = adjugate[4] * x47 + adjugate[5] * x50;
    const scalar_t x54 = x53 * x8;
    const scalar_t x55 = adjugate[1] * x47 + adjugate[2] * x50;
    const scalar_t x56 = x3 * x55;
    const scalar_t x57 = qy * x7;
    const scalar_t x58 = x12 * x57;
    const scalar_t x59 = x0 * (x10 - x46 - x58);
    const scalar_t x60 = x20 * x57;
    const scalar_t x61 = x0 * (x19 - x49 - x60);
    const scalar_t x62 = adjugate[7] * x59 + adjugate[8] * x61;
    const scalar_t x63 = x11 * x62;
    const scalar_t x64 = adjugate[4] * x59 + adjugate[5] * x61;
    const scalar_t x65 = x64 * x8;
    const scalar_t x66 = adjugate[1] * x59 + adjugate[2] * x61;
    const scalar_t x67 = x3 * x66;
    const scalar_t x68 = qz * x1;
    const scalar_t x69 = x5 * x68;
    const scalar_t x70 = qz * x7;
    const scalar_t x71 = x70 * x9;
    const scalar_t x72 = x0 * (x13 - x69 - x71);
    const scalar_t x73 = x16 * x68;
    const scalar_t x74 = x18 * x70;
    const scalar_t x75 = x0 * (x21 - x73 - x74);
    const scalar_t x76 = adjugate[7] * x72 + adjugate[8] * x75;
    const scalar_t x77 = x11 * x76;
    const scalar_t x78 = adjugate[4] * x72 + adjugate[5] * x75;
    const scalar_t x79 = x78 * x8;
    const scalar_t x80 = adjugate[1] * x72 + adjugate[2] * x75;
    const scalar_t x81 = x3 * x80;
    const scalar_t x82 = qx * qz;
    const scalar_t x83 = x82 * x9;
    const scalar_t x84 = x0 * (x32 + x69 - x83);
    const scalar_t x85 = x18 * x82;
    const scalar_t x86 = x0 * (x35 + x73 - x85);
    const scalar_t x87 = adjugate[7] * x84 + adjugate[8] * x86;
    const scalar_t x88 = x11 * x87;
    const scalar_t x89 = adjugate[4] * x84 + adjugate[5] * x86;
    const scalar_t x90 = x8 * x89;
    const scalar_t x91 = adjugate[1] * x84 + adjugate[2] * x86;
    const scalar_t x92 = x3 * x91;
    const scalar_t x93 = qy * qz;
    const scalar_t x94 = x5 * x93;
    const scalar_t x95 = x0 * (x44 + x83 + x94);
    const scalar_t x96 = x16 * x93;
    const scalar_t x97 = x0 * (x48 + x85 + x96);
    const scalar_t x98 = adjugate[7] * x95 + adjugate[8] * x97;
    const scalar_t x99 = x11 * x98;
    const scalar_t x100 = adjugate[4] * x95 + adjugate[5] * x97;
    const scalar_t x101 = x100 * x8;
    const scalar_t x102 = adjugate[1] * x95 + adjugate[2] * x97;
    const scalar_t x103 = x102 * x3;
    const scalar_t x104 = x0 * (x58 + x71 - x94);
    const scalar_t x105 = x0 * (x60 + x74 - x96);
    const scalar_t x106 = adjugate[7] * x104 + adjugate[8] * x105;
    const scalar_t x107 = x106 * x11;
    const scalar_t x108 = adjugate[4] * x104 + adjugate[5] * x105;
    const scalar_t x109 = x108 * x8;
    const scalar_t x110 = adjugate[1] * x104 + adjugate[2] * x105;
    const scalar_t x111 = x110 * x3;
    const scalar_t x112 = x23 * x31;
    const scalar_t x113 = x25 * x29;
    const scalar_t x114 = x31 * x37;
    const scalar_t x115 = x29 * x39;
    const scalar_t x116 = x31 * x51;
    const scalar_t x117 = x29 * x53;
    const scalar_t x118 = x31 * x62;
    const scalar_t x119 = x29 * x64;
    const scalar_t x120 = x31 * x76;
    const scalar_t x121 = x29 * x78;
    const scalar_t x122 = x31 * x87;
    const scalar_t x123 = x29 * x89;
    const scalar_t x124 = x31 * x98;
    const scalar_t x125 = x100 * x29;
    const scalar_t x126 = x106 * x31;
    const scalar_t x127 = x108 * x29;
    const scalar_t x128 = x23 * x43;
    const scalar_t x129 = x27 * x45;
    const scalar_t x130 = x37 * x43;
    const scalar_t x131 = x41 * x45;
    const scalar_t x132 = x43 * x51;
    const scalar_t x133 = x45 * x55;
    const scalar_t x134 = x43 * x62;
    const scalar_t x135 = x45 * x66;
    const scalar_t x136 = x43 * x76;
    const scalar_t x137 = x45 * x80;
    const scalar_t x138 = x43 * x87;
    const scalar_t x139 = x45 * x91;
    const scalar_t x140 = x43 * x98;
    const scalar_t x141 = x102 * x45;
    const scalar_t x142 = x106 * x43;
    const scalar_t x143 = x110 * x45;
    const scalar_t x144 = x23 * x57;
    const scalar_t x145 = x37 * x57;
    const scalar_t x146 = x51 * x57;
    const scalar_t x147 = x57 * x62;
    const scalar_t x148 = x57 * x76;
    const scalar_t x149 = x57 * x87;
    const scalar_t x150 = x57 * x98;
    const scalar_t x151 = x106 * x57;
    const scalar_t x152 = x25 * x70;
    const scalar_t x153 = x27 * x68;
    const scalar_t x154 = x39 * x70;
    const scalar_t x155 = x41 * x68;
    const scalar_t x156 = x53 * x70;
    const scalar_t x157 = x55 * x68;
    const scalar_t x158 = x64 * x70;
    const scalar_t x159 = x66 * x68;
    const scalar_t x160 = x70 * x78;
    const scalar_t x161 = x68 * x80;
    const scalar_t x162 = x70 * x89;
    const scalar_t x163 = x68 * x91;
    const scalar_t x164 = x100 * x70;
    const scalar_t x165 = x102 * x68;
    const scalar_t x166 = x108 * x70;
    const scalar_t x167 = x110 * x68;
    const scalar_t x168 = x25 * x82;
    const scalar_t x169 = x39 * x82;
    const scalar_t x170 = x53 * x82;
    const scalar_t x171 = x64 * x82;
    const scalar_t x172 = x78 * x82;
    const scalar_t x173 = x82 * x89;
    const scalar_t x174 = x100 * x82;
    const scalar_t x175 = x108 * x82;
    const scalar_t x176 = x27 * x93;
    const scalar_t x177 = x41 * x93;
    const scalar_t x178 = x55 * x93;
    const scalar_t x179 = x66 * x93;
    const scalar_t x180 = x80 * x93;
    const scalar_t x181 = x91 * x93;
    const scalar_t x182 = x102 * x93;
    const scalar_t x183 = x110 * x93;
    element_matrix[0] += -x24 - x26 - x28;
    element_matrix[1] += -x38 - x40 - x42;
    element_matrix[2] += -x52 - x54 - x56;
    element_matrix[3] += -x63 - x65 - x67;
    element_matrix[4] += -x77 - x79 - x81;
    element_matrix[5] += -x88 - x90 - x92;
    element_matrix[6] += -x101 - x103 - x99;
    element_matrix[7] += -x107 - x109 - x111;
    element_matrix[8] += -x112 - x113 + x28;
    element_matrix[9] += -x114 - x115 + x42;
    element_matrix[10] += -x116 - x117 + x56;
    element_matrix[11] += -x118 - x119 + x67;
    element_matrix[12] += -x120 - x121 + x81;
    element_matrix[13] += -x122 - x123 + x92;
    element_matrix[14] += x103 - x124 - x125;
    element_matrix[15] += x111 - x126 - x127;
    element_matrix[16] += x113 - x128 + x129;
    element_matrix[17] += x115 - x130 + x131;
    element_matrix[18] += x117 - x132 + x133;
    element_matrix[19] += x119 - x134 + x135;
    element_matrix[20] += x121 - x136 + x137;
    element_matrix[21] += x123 - x138 + x139;
    element_matrix[22] += x125 - x140 + x141;
    element_matrix[23] += x127 - x142 + x143;
    element_matrix[24] += -x129 - x144 + x26;
    element_matrix[25] += -x131 - x145 + x40;
    element_matrix[26] += -x133 - x146 + x54;
    element_matrix[27] += -x135 - x147 + x65;
    element_matrix[28] += -x137 - x148 + x79;
    element_matrix[29] += -x139 - x149 + x90;
    element_matrix[30] += x101 - x141 - x150;
    element_matrix[31] += x109 - x143 - x151;
    element_matrix[32] += -x152 - x153 + x24;
    element_matrix[33] += -x154 - x155 + x38;
    element_matrix[34] += -x156 - x157 + x52;
    element_matrix[35] += -x158 - x159 + x63;
    element_matrix[36] += -x160 - x161 + x77;
    element_matrix[37] += -x162 - x163 + x88;
    element_matrix[38] += -x164 - x165 + x99;
    element_matrix[39] += x107 - x166 - x167;
    element_matrix[40] += x112 + x153 - x168;
    element_matrix[41] += x114 + x155 - x169;
    element_matrix[42] += x116 + x157 - x170;
    element_matrix[43] += x118 + x159 - x171;
    element_matrix[44] += x120 + x161 - x172;
    element_matrix[45] += x122 + x163 - x173;
    element_matrix[46] += x124 + x165 - x174;
    element_matrix[47] += x126 + x167 - x175;
    element_matrix[48] += x128 + x168 + x176;
    element_matrix[49] += x130 + x169 + x177;
    element_matrix[50] += x132 + x170 + x178;
    element_matrix[51] += x134 + x171 + x179;
    element_matrix[52] += x136 + x172 + x180;
    element_matrix[53] += x138 + x173 + x181;
    element_matrix[54] += x140 + x174 + x182;
    element_matrix[55] += x142 + x175 + x183;
    element_matrix[56] += x144 + x152 - x176;
    element_matrix[57] += x145 + x154 - x177;
    element_matrix[58] += x146 + x156 - x178;
    element_matrix[59] += x147 + x158 - x179;
    element_matrix[60] += x148 + x160 - x180;
    element_matrix[61] += x149 + x162 - x181;
    element_matrix[62] += x150 + x164 - x182;
    element_matrix[63] += x151 + x166 - x183;
}

//--------------------------
// hessian block_2_2
//--------------------------

template <typename scalar_t, typename accumulator_t>
static inline __host__ __device__ void cu_hex8_linear_elasticity_matrix_block_2_2(
        const scalar_t mu,
        const scalar_t lambda,
        const scalar_t *const SFEM_RESTRICT adjugate,
        const scalar_t jacobian_determinant,
        const scalar_t qx,
        const scalar_t qy,
        const scalar_t qz,
        const scalar_t qw,
        accumulator_t *const SFEM_RESTRICT element_matrix) {
    const scalar_t x0 = 1.0 / jacobian_determinant;
    const scalar_t x1 = 1 - qy;
    const scalar_t x2 = 1 - qz;
    const scalar_t x3 = x1 * x2;
    const scalar_t x4 = mu * qw;
    const scalar_t x5 = x3 * x4;
    const scalar_t x6 = adjugate[0] * x5;
    const scalar_t x7 = 1 - qx;
    const scalar_t x8 = x2 * x7;
    const scalar_t x9 = x4 * x8;
    const scalar_t x10 = adjugate[3] * x9;
    const scalar_t x11 = x1 * x7;
    const scalar_t x12 = x11 * x4;
    const scalar_t x13 = adjugate[6] * x12;
    const scalar_t x14 = x0 * (-x10 - x13 - x6);
    const scalar_t x15 = adjugate[1] * x5;
    const scalar_t x16 = adjugate[4] * x9;
    const scalar_t x17 = adjugate[7] * x12;
    const scalar_t x18 = x0 * (-x15 - x16 - x17);
    const scalar_t x19 = qw * (lambda + 2 * mu);
    const scalar_t x20 = adjugate[2] * x19;
    const scalar_t x21 = x20 * x3;
    const scalar_t x22 = adjugate[5] * x19;
    const scalar_t x23 = x22 * x8;
    const scalar_t x24 = adjugate[8] * x19;
    const scalar_t x25 = x11 * x24;
    const scalar_t x26 = x0 * (-x21 - x23 - x25);
    const scalar_t x27 = adjugate[6] * x14 + adjugate[7] * x18 + adjugate[8] * x26;
    const scalar_t x28 = x11 * x27;
    const scalar_t x29 = adjugate[3] * x14 + adjugate[4] * x18 + adjugate[5] * x26;
    const scalar_t x30 = x29 * x8;
    const scalar_t x31 = adjugate[0] * x14 + adjugate[1] * x18 + adjugate[2] * x26;
    const scalar_t x32 = x3 * x31;
    const scalar_t x33 = qx * x2;
    const scalar_t x34 = x33 * x4;
    const scalar_t x35 = adjugate[3] * x34;
    const scalar_t x36 = qx * x1;
    const scalar_t x37 = x36 * x4;
    const scalar_t x38 = adjugate[6] * x37;
    const scalar_t x39 = x0 * (-x35 - x38 + x6);
    const scalar_t x40 = adjugate[4] * x34;
    const scalar_t x41 = adjugate[7] * x37;
    const scalar_t x42 = x0 * (x15 - x40 - x41);
    const scalar_t x43 = x22 * x33;
    const scalar_t x44 = x24 * x36;
    const scalar_t x45 = x0 * (x21 - x43 - x44);
    const scalar_t x46 = adjugate[6] * x39 + adjugate[7] * x42 + adjugate[8] * x45;
    const scalar_t x47 = x11 * x46;
    const scalar_t x48 = adjugate[3] * x39 + adjugate[4] * x42 + adjugate[5] * x45;
    const scalar_t x49 = x48 * x8;
    const scalar_t x50 = adjugate[0] * x39 + adjugate[1] * x42 + adjugate[2] * x45;
    const scalar_t x51 = x3 * x50;
    const scalar_t x52 = qx * qy;
    const scalar_t x53 = x4 * x52;
    const scalar_t x54 = adjugate[6] * x53;
    const scalar_t x55 = qy * x2;
    const scalar_t x56 = x4 * x55;
    const scalar_t x57 = adjugate[0] * x56;
    const scalar_t x58 = x0 * (x35 - x54 + x57);
    const scalar_t x59 = adjugate[7] * x53;
    const scalar_t x60 = adjugate[1] * x56;
    const scalar_t x61 = x0 * (x40 - x59 + x60);
    const scalar_t x62 = x24 * x52;
    const scalar_t x63 = x20 * x55;
    const scalar_t x64 = x0 * (x43 - x62 + x63);
    const scalar_t x65 = adjugate[6] * x58 + adjugate[7] * x61 + adjugate[8] * x64;
    const scalar_t x66 = x11 * x65;
    const scalar_t x67 = adjugate[3] * x58 + adjugate[4] * x61 + adjugate[5] * x64;
    const scalar_t x68 = x67 * x8;
    const scalar_t x69 = adjugate[0] * x58 + adjugate[1] * x61 + adjugate[2] * x64;
    const scalar_t x70 = x3 * x69;
    const scalar_t x71 = qy * x7;
    const scalar_t x72 = x4 * x71;
    const scalar_t x73 = adjugate[6] * x72;
    const scalar_t x74 = x0 * (x10 - x57 - x73);
    const scalar_t x75 = adjugate[7] * x72;
    const scalar_t x76 = x0 * (x16 - x60 - x75);
    const scalar_t x77 = x24 * x71;
    const scalar_t x78 = x0 * (x23 - x63 - x77);
    const scalar_t x79 = adjugate[6] * x74 + adjugate[7] * x76 + adjugate[8] * x78;
    const scalar_t x80 = x11 * x79;
    const scalar_t x81 = adjugate[3] * x74 + adjugate[4] * x76 + adjugate[5] * x78;
    const scalar_t x82 = x8 * x81;
    const scalar_t x83 = adjugate[0] * x74 + adjugate[1] * x76 + adjugate[2] * x78;
    const scalar_t x84 = x3 * x83;
    const scalar_t x85 = qz * x1;
    const scalar_t x86 = x4 * x85;
    const scalar_t x87 = adjugate[0] * x86;
    const scalar_t x88 = qz * x7;
    const scalar_t x89 = x4 * x88;
    const scalar_t x90 = adjugate[3] * x89;
    const scalar_t x91 = x0 * (x13 - x87 - x90);
    const scalar_t x92 = adjugate[1] * x86;
    const scalar_t x93 = adjugate[4] * x89;
    const scalar_t x94 = x0 * (x17 - x92 - x93);
    const scalar_t x95 = x20 * x85;
    const scalar_t x96 = x22 * x88;
    const scalar_t x97 = x0 * (x25 - x95 - x96);
    const scalar_t x98 = adjugate[6] * x91 + adjugate[7] * x94 + adjugate[8] * x97;
    const scalar_t x99 = x11 * x98;
    const scalar_t x100 = adjugate[3] * x91 + adjugate[4] * x94 + adjugate[5] * x97;
    const scalar_t x101 = x100 * x8;
    const scalar_t x102 = adjugate[0] * x91 + adjugate[1] * x94 + adjugate[2] * x97;
    const scalar_t x103 = x102 * x3;
    const scalar_t x104 = qx * qz;
    const scalar_t x105 = x104 * x4;
    const scalar_t x106 = adjugate[3] * x105;
    const scalar_t x107 = x0 * (-x106 + x38 + x87);
    const scalar_t x108 = adjugate[4] * x105;
    const scalar_t x109 = x0 * (-x108 + x41 + x92);
    const scalar_t x110 = x104 * x22;
    const scalar_t x111 = x0 * (-x110 + x44 + x95);
    const scalar_t x112 = adjugate[6] * x107 + adjugate[7] * x109 + adjugate[8] * x111;
    const scalar_t x113 = x11 * x112;
    const scalar_t x114 = adjugate[3] * x107 + adjugate[4] * x109 + adjugate[5] * x111;
    const scalar_t x115 = x114 * x8;
    const scalar_t x116 = adjugate[0] * x107 + adjugate[1] * x109 + adjugate[2] * x111;
    const scalar_t x117 = x116 * x3;
    const scalar_t x118 = qy * qz;
    const scalar_t x119 = x118 * x4;
    const scalar_t x120 = adjugate[0] * x119;
    const scalar_t x121 = x0 * (x106 + x120 + x54);
    const scalar_t x122 = adjugate[1] * x119;
    const scalar_t x123 = x0 * (x108 + x122 + x59);
    const scalar_t x124 = x118 * x20;
    const scalar_t x125 = x0 * (x110 + x124 + x62);
    const scalar_t x126 = adjugate[6] * x121 + adjugate[7] * x123 + adjugate[8] * x125;
    const scalar_t x127 = x11 * x126;
    const scalar_t x128 = adjugate[3] * x121 + adjugate[4] * x123 + adjugate[5] * x125;
    const scalar_t x129 = x128 * x8;
    const scalar_t x130 = adjugate[0] * x121 + adjugate[1] * x123 + adjugate[2] * x125;
    const scalar_t x131 = x130 * x3;
    const scalar_t x132 = x0 * (-x120 + x73 + x90);
    const scalar_t x133 = x0 * (-x122 + x75 + x93);
    const scalar_t x134 = x0 * (-x124 + x77 + x96);
    const scalar_t x135 = adjugate[6] * x132 + adjugate[7] * x133 + adjugate[8] * x134;
    const scalar_t x136 = x11 * x135;
    const scalar_t x137 = adjugate[3] * x132 + adjugate[4] * x133 + adjugate[5] * x134;
    const scalar_t x138 = x137 * x8;
    const scalar_t x139 = adjugate[0] * x132 + adjugate[1] * x133 + adjugate[2] * x134;
    const scalar_t x140 = x139 * x3;
    const scalar_t x141 = x27 * x36;
    const scalar_t x142 = x29 * x33;
    const scalar_t x143 = x36 * x46;
    const scalar_t x144 = x33 * x48;
    const scalar_t x145 = x36 * x65;
    const scalar_t x146 = x33 * x67;
    const scalar_t x147 = x36 * x79;
    const scalar_t x148 = x33 * x81;
    const scalar_t x149 = x36 * x98;
    const scalar_t x150 = x100 * x33;
    const scalar_t x151 = x112 * x36;
    const scalar_t x152 = x114 * x33;
    const scalar_t x153 = x126 * x36;
    const scalar_t x154 = x128 * x33;
    const scalar_t x155 = x135 * x36;
    const scalar_t x156 = x137 * x33;
    const scalar_t x157 = x27 * x52;
    const scalar_t x158 = x31 * x55;
    const scalar_t x159 = x46 * x52;
    const scalar_t x160 = x50 * x55;
    const scalar_t x161 = x52 * x65;
    const scalar_t x162 = x55 * x69;
    const scalar_t x163 = x52 * x79;
    const scalar_t x164 = x55 * x83;
    const scalar_t x165 = x52 * x98;
    const scalar_t x166 = x102 * x55;
    const scalar_t x167 = x112 * x52;
    const scalar_t x168 = x116 * x55;
    const scalar_t x169 = x126 * x52;
    const scalar_t x170 = x130 * x55;
    const scalar_t x171 = x135 * x52;
    const scalar_t x172 = x139 * x55;
    const scalar_t x173 = x27 * x71;
    const scalar_t x174 = x46 * x71;
    const scalar_t x175 = x65 * x71;
    const scalar_t x176 = x71 * x79;
    const scalar_t x177 = x71 * x98;
    const scalar_t x178 = x112 * x71;
    const scalar_t x179 = x126 * x71;
    const scalar_t x180 = x135 * x71;
    const scalar_t x181 = x29 * x88;
    const scalar_t x182 = x31 * x85;
    const scalar_t x183 = x48 * x88;
    const scalar_t x184 = x50 * x85;
    const scalar_t x185 = x67 * x88;
    const scalar_t x186 = x69 * x85;
    const scalar_t x187 = x81 * x88;
    const scalar_t x188 = x83 * x85;
    const scalar_t x189 = x100 * x88;
    const scalar_t x190 = x102 * x85;
    const scalar_t x191 = x114 * x88;
    const scalar_t x192 = x116 * x85;
    const scalar_t x193 = x128 * x88;
    const scalar_t x194 = x130 * x85;
    const scalar_t x195 = x137 * x88;
    const scalar_t x196 = x139 * x85;
    const scalar_t x197 = x104 * x29;
    const scalar_t x198 = x104 * x48;
    const scalar_t x199 = x104 * x67;
    const scalar_t x200 = x104 * x81;
    const scalar_t x201 = x100 * x104;
    const scalar_t x202 = x104 * x114;
    const scalar_t x203 = x104 * x128;
    const scalar_t x204 = x104 * x137;
    const scalar_t x205 = x118 * x31;
    const scalar_t x206 = x118 * x50;
    const scalar_t x207 = x118 * x69;
    const scalar_t x208 = x118 * x83;
    const scalar_t x209 = x102 * x118;
    const scalar_t x210 = x116 * x118;
    const scalar_t x211 = x118 * x130;
    const scalar_t x212 = x118 * x139;
    element_matrix[0] += -x28 - x30 - x32;
    element_matrix[1] += -x47 - x49 - x51;
    element_matrix[2] += -x66 - x68 - x70;
    element_matrix[3] += -x80 - x82 - x84;
    element_matrix[4] += -x101 - x103 - x99;
    element_matrix[5] += -x113 - x115 - x117;
    element_matrix[6] += -x127 - x129 - x131;
    element_matrix[7] += -x136 - x138 - x140;
    element_matrix[8] += -x141 - x142 + x32;
    element_matrix[9] += -x143 - x144 + x51;
    element_matrix[10] += -x145 - x146 + x70;
    element_matrix[11] += -x147 - x148 + x84;
    element_matrix[12] += x103 - x149 - x150;
    element_matrix[13] += x117 - x151 - x152;
    element_matrix[14] += x131 - x153 - x154;
    element_matrix[15] += x140 - x155 - x156;
    element_matrix[16] += x142 - x157 + x158;
    element_matrix[17] += x144 - x159 + x160;
    element_matrix[18] += x146 - x161 + x162;
    element_matrix[19] += x148 - x163 + x164;
    element_matrix[20] += x150 - x165 + x166;
    element_matrix[21] += x152 - x167 + x168;
    element_matrix[22] += x154 - x169 + x170;
    element_matrix[23] += x156 - x171 + x172;
    element_matrix[24] += -x158 - x173 + x30;
    element_matrix[25] += -x160 - x174 + x49;
    element_matrix[26] += -x162 - x175 + x68;
    element_matrix[27] += -x164 - x176 + x82;
    element_matrix[28] += x101 - x166 - x177;
    element_matrix[29] += x115 - x168 - x178;
    element_matrix[30] += x129 - x170 - x179;
    element_matrix[31] += x138 - x172 - x180;
    element_matrix[32] += -x181 - x182 + x28;
    element_matrix[33] += -x183 - x184 + x47;
    element_matrix[34] += -x185 - x186 + x66;
    element_matrix[35] += -x187 - x188 + x80;
    element_matrix[36] += -x189 - x190 + x99;
    element_matrix[37] += x113 - x191 - x192;
    element_matrix[38] += x127 - x193 - x194;
    element_matrix[39] += x136 - x195 - x196;
    element_matrix[40] += x141 + x182 - x197;
    element_matrix[41] += x143 + x184 - x198;
    element_matrix[42] += x145 + x186 - x199;
    element_matrix[43] += x147 + x188 - x200;
    element_matrix[44] += x149 + x190 - x201;
    element_matrix[45] += x151 + x192 - x202;
    element_matrix[46] += x153 + x194 - x203;
    element_matrix[47] += x155 + x196 - x204;
    element_matrix[48] += x157 + x197 + x205;
    element_matrix[49] += x159 + x198 + x206;
    element_matrix[50] += x161 + x199 + x207;
    element_matrix[51] += x163 + x200 + x208;
    element_matrix[52] += x165 + x201 + x209;
    element_matrix[53] += x167 + x202 + x210;
    element_matrix[54] += x169 + x203 + x211;
    element_matrix[55] += x171 + x204 + x212;
    element_matrix[56] += x173 + x181 - x205;
    element_matrix[57] += x174 + x183 - x206;
    element_matrix[58] += x175 + x185 - x207;
    element_matrix[59] += x176 + x187 - x208;
    element_matrix[60] += x177 + x189 - x209;
    element_matrix[61] += x178 + x191 - x210;
    element_matrix[62] += x179 + x193 - x211;
    element_matrix[63] += x180 + x195 - x212;
}

#endif  // CU_HEX8_LINEAR_ELASTICITY_INLINE_HPP
